{"version":3,"file":"main.js","mappings":";;;;;;;;;;;;;;;;AACuD;AAE4B;;;AAEnF,MAAM,MAAM,GAAW;IACrB,EAAE,IAAI,EAAE,IAAI,EAAE,SAAS,EAAE,4FAAkB,EAAE,EAAG,sBAAsB;CACvE,CAAC;AAMK,MAAM,gBAAgB;;gFAAhB,gBAAgB;6GAAhB,gBAAgB;iHAHjB,iEAAoB,CAAC,MAAM,CAAC,EAC5B,yDAAY;mIAEX,gBAAgB,oFAFjB,yDAAY;;;;;;;;;;;;;;;;;;;ACJjB,MAAM,YAAY;IALzB;QAME,UAAK,GAAG,eAAe,CAAC;KACzB;;wEAFY,YAAY;0GAAZ,YAAY;QCPzB,2EAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;ACC2B;AACF;AAEA;AACT;AAEmB;AACP;AACF;AACqB;AAEV;AACW;;AAqBxE,MAAM,SAAS;;kEAAT,SAAS;sGAAT,SAAS,cAFR,wDAAY;0GAXtB,oEAAa;QACb,iEAAgB;QAChB,6EAAgB;QAChB,kEAAgB;QAChB,yFAAuB;QACvB,4EAAkB;QAClB,qEAAe;QACf,mEAAe;QACf,yFAAwB;mIAKf,SAAS,mBAhBlB,wDAAY,aAGZ,oEAAa;QACb,iEAAgB;QAChB,6EAAgB;QAChB,kEAAgB;QAChB,yFAAuB;QACvB,4EAAkB;QAClB,qEAAe;QACf,mEAAe;QACf,yFAAwB;;;;;;;;;;;;;;;;;ACxBrB,MAAM,aAAa;IAExB,SAAS,CAAC,KAAa;QACrB,mBAAmB;QACnB,OAAO,KAAK,KAAK,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC;IACvC,CAAC;;0EALU,aAAa;0HAAb,aAAa;;;;;;;;;;;;;;;;;ACAnB,MAAM,SAAS;IAEpB,SAAS,CAAC,KAAU,EAAE,YAAoB,CAAC;QACzC,aAAa;QACb,MAAM,YAAY,GAAG,UAAU,CAAC,KAAK,CAAC,CAAC;QAEvC,aAAa;QACb,IAAI,KAAK,CAAC,YAAY,CAAC,EAAE;YACvB,OAAO,KAAK,CAAC,CAAE,mBAAmB;SACnC;QAED,yBAAyB;QACzB,MAAM,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC,CAAC,SAAS;QACjD,OAAO,IAAI,CAAC,KAAK,CAAC,YAAY,GAAG,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC,aAAa;IAClE,CAAC;;kEAdU,SAAS;kHAAT,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AGLoF;AAEH,CAAE,eAAe;AAK7F;;;;;;;;IC0BT,0EAC+F;IAC7F,yEACF;IAAA,4DAAM;;;IACN,0EACqG;IACnG,+EACF;IAAA,4DAAM;;;IAIR,sEAAgE;IAEhC,8EAAS;IAAA,4DAAO;IAC5C,2EAAyC;IAAA,uDAAuC;IAAA,4DAAO;IACvF,2EAAgC;IAAA,iEAAC;IAAA,4DAAO;IACxC,2EAA2B;IACzB,uDACF;;IAAA,4DAAO;IAET,yEAAiD;IAAA,wDAAkD;;IAAA,4DAAI;IACvG,yEAAiD;IAAA,wDAAoD;;IAAA,4DAAI;;;;IAP9D,0DAAuC;IAAvC,6GAAuC;IAG9E,0DACF;IADE,+LACF;IAE+C,0DAAkD;IAAlD,4MAAkD;IAClD,0DAAoD;IAApD,yMAAoD;;;IAGvG,sEAAgE;IAEX,+HAAa;IAAA,4DAAI;;;IA5C5E,qEAA8D;IAE1D,qEACgG;IAEhG,0EAAoB;IAId,uDACF;IAAA,4DAAK;IACL,0EAA8G;IAC5G,uDACF;IAAA,4DAAM;IAIR,0EAAiC;IAC/B,mKAGM;IACN,mKAGM;IACR,4DAAM;IAGN,oKAWM;IAEN,kKAIM;IACR,4DAAM;;;;IA7CD,0DAAiC;IAAjC,iKAAiC;IAOhC,0DACF;IADE,4FACF;IAEE,0DACF;IADE,0HACF;IAKM,0DAAwC;IAAxC,8GAAwC;IAIxC,0DAAiD;IAAjD,uHAAiD;IAOnD,0DAAwD;IAAxD,iKAAwD;IAaxD,0DAAwD;IAAxD,iKAAwD;;;IApDxE,yEAC6F;IAGvF,uDACF;IAAA,4DAAK;IAIP,wEAAmC;IACjC,0JAiDK;IACP,4DAAK;;;;IAxDD,0DACF;IADE,+FACF;IAKqB,0DAAuC;IAAvC,mHAAuC;;;IAXlE,wEAAwD;IACtD,qJA6DM;IACR,qEAAe;;;;IA9DP,0DAA6F;IAA7F,6KAA6F;;;IAHvG,wEAAoC;IAClC,wEAAoC;IAAA,uDAAmB;IAAA,4DAAK;IAC5D,wJA+De;IACjB,qEAAe;;;IAjEuB,0DAAmB;IAAnB,qFAAmB;IACjB,0DAAgB;IAAhB,yFAAgB;;;IAgFhD,qEAA8D;IAKtD,uDACF;IAAA,4DAAK;IACL,0EAA8G;IAC5G,uDACF;IAAA,4DAAM;;;IAJJ,0DACF;IADE,6FACF;IAEE,0DACF;IADE,2HACF;;;IAnBV,yEAC6F;IAGvF,uDACF;IAAA,4DAAK;IAIP,wEAAmC;IACjC,yJAYK;IACP,4DAAK;;;;IAnBD,0DACF;IADE,gGACF;IAKqB,0DAAuC;IAAvC,qHAAuC;;;IAXlE,wEAAwD;IACtD,qJAwBM;IACR,qEAAe;;;;IAzBP,0DAA6F;IAA7F,iLAA6F;;;IAHvG,wEAAoC;IAClC,wEAAoC;IAAA,uDAAmB;IAAA,4DAAK;IAC5D,wJA0Be;IACjB,qEAAe;;;IA5BuB,0DAAmB;IAAnB,qFAAmB;IACjB,0DAAgB;IAAhB,yFAAgB;;;IAzE1D,8EAAmE;IAEjE,yIAkEe;IAGf,yIA6Be;IACjB,4DAAW;;;IAnGM,0DAAmB;IAAnB,sFAAmB;IAqEnB,0DAAmB;IAAnB,sFAAmB;;ADzD7B,MAAM,gBAAgB;IAS3B,YACU,yBAAoD;QAApD,8BAAyB,GAAzB,yBAAyB,CAA2B;QAN9D,kBAAa,GAAU,EAAE,CAAC;QAC1B,uBAAkB,GAA8B,EAAE,CAAC,CAAE,eAAe;QAEpE,gBAAW,GAAiB,EAAE,CAAC;IAI5B,CAAC;IAEJ,QAAQ;QACN,2BAA2B;QAC3B,IAAI,CAAC,yBAAyB,CAAC,cAAc,EAAE,CAAC,SAAS,CAAC,CAAC,IAAI,EAAE,EAAE;YACjE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;YACxB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAChC,CAAC,CAAC;IACJ,CAAC;IAED,WAAW,CAAC,OAAsB;QAChC,sBAAsB;QACtB,IAAI,OAAO,CAAC,UAAU,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,EAAE;YAC3C,IAAI,CAAC,iBAAiB,EAAE,CAAC,CAAE,YAAY;SACxC;IACH,CAAC;IAED,iBAAiB;QACf,IAAI,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,QAAQ,EAAE;YAC/B,IAAI,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE;gBACxB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAE,UAAU;gBACxD,OAAO,CAAC,GAAG,CAAC,eAAe,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;gBACjD,IAAI,CAAC,sBAAsB,EAAE,CAAC,CAAE,gBAAgB;aACjD;iBACI,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE;gBACxB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC,UAAU;gBAC7C,OAAO,CAAC,GAAG,CAAC,eAAe,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;gBACjD,8BAA8B;gBAC9B,IAAI,KAAK,GAAW,EAAE,CAAC;gBACvB,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,EAAE;oBACjC,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC;oBACvB,KAAK,CAAC,IAAI,CACR,GAAG,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAqB,EAAE,EAAE,CAAC,CAAC;wBAC9C,QAAQ,EAAE,OAAO,CAAC,IAAI;wBACtB,YAAY,EAAE,OAAO,CAAC,GAAG,EAAK,mBAAmB;qBAClD,CAAC,CAAC,CACJ,CAAC;oBACF,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,KAAK,IAAI,EAAE,CAAC;oBAChD,KAAK,GAAG,EAAE,CAAC;gBACb,CAAC,CAAC,CAAC;gBACH,OAAO,CAAC,GAAG,CAAC,oBAAoB,EAAE,IAAI,CAAC,kBAAkB,CAAC;aAC3D;SACF;IACH,CAAC;IAED,sBAAsB;QACpB,IAAI,IAAI,CAAC,KAAK,EAAE;YACd,IAAI,CAAC,yBAAyB,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE;gBACxF,IAAI,QAAQ,CAAC,SAAS,IAAI,QAAQ,CAAC,OAAO,CAAC,cAAc,EAAE;oBACzD,MAAM,kBAAkB,GAAwB,QAAQ,CAAC,OAAO,CAAC,cAAc,CAAC,kBAAkB,CAAC;oBAEnG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE;wBACvC,MAAM,KAAK,GAAW,EAAE,CAAC;wBAEzB,8CAA8C;wBAC9C,kBAAkB,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;4BACpC,IAAI,QAAQ,CAAC,IAAI,KAAK,WAAW,CAAC,IAAI,EAAE;gCACtC,KAAK,CAAC,IAAI,CAAC,GAAG,QAAQ,CAAC,QAAQ,CAAC,CAAC;6BAClC;wBACH,CAAC,CAAC,CAAC;wBAEH,4BAA4B;wBAC5B,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,KAAK,IAAI,EAAE,CAAC;oBAC1D,CAAC,CAAC,CAAC;iBACJ;gBACD,OAAO,CAAC,GAAG,CAAC,oBAAoB,EAAE,IAAI,CAAC,kBAAkB,CAAC;YAC5D,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IAED,uDAAuD;IACvD,iBAAiB;IACjB,4DAA4D;IAC5D,iBAAiB;IACjB,8BAA8B;IAC9B,kCAAkC;IAClC,UAAU;IACV,MAAM;IACN,gBAAgB;IAChB,IAAI;IAEJ,kBAAkB,CAAC,aAAqB;QACtC,OAAO;QACP,MAAM,KAAK,GAAG,UAAU,CAAC,aAAa,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;QAClE,MAAM,WAAW,GAAG,IAAI,IAAI,EAAE,CAAC;QAC/B,MAAM,WAAW,GAAG,WAAW,CAAC,QAAQ,EAAE,CAAC;QAE3C,IAAI,eAAe,GAAG,KAAK,CAAC;QAE5B,SAAS;QACT,IAAI,WAAW,IAAI,EAAE,IAAI,WAAW,GAAG,EAAE,EAAE;YACzC,eAAe,IAAI,GAAG,CAAC,CAAC,iBAAiB;SAC1C;aAAM,IAAI,CAAC,WAAW,IAAI,EAAE,IAAI,WAAW,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,IAAI,EAAE,IAAI,WAAW,GAAG,CAAC,CAAC,EAAE;YAC5F,eAAe,IAAI,IAAI,CAAC,CAAC,iCAAiC;SAC3D;aACI;YACH,sBAAsB;YACtB,eAAe,IAAI,GAAG,CAAC;SACxB;QACD,OAAO,eAAe,CAAC,QAAQ,EAAE,CAAC;IACpC,CAAC;IAED,aAAa,CAAC,IAAU;QACtB,kBAAkB;QAClB,MAAM,OAAO,GAAG;YACd,YAAY,EAAE,IAAI;YAClB,SAAS,EAAE,GAAG;YACd,IAAI,EAAE,CAAC,MAAM,CAAC,CAAC,gBAAgB;SAChC,CAAC;QAEF,kBAAkB;QAClB,MAAM,IAAI,GAAG,IAAI,+CAAI,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;QAEjD,WAAW;QACX,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAE1C,oBAAoB;QACpB,MAAM,UAAU,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;YACtD,QAAQ,EAAE,EAAE;YACZ,OAAO,EAAE,EAAE;YACX,KAAK,EAAE,oBAAoB;YAC3B,IAAI,EAAE,EAAE;YACR,IAAI,EAAE,EAAE;YACR,GAAG,EAAE,OAAO;YACZ,KAAK,EAAE,EAAE;YACT,YAAY,EAAE,OAAO;SACtB,CAAC;QAEF,WAAW;QACX,MAAM,eAAe,GAAG,IAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;QAElE,0BAA0B;QAC1B,UAAU,CAAC,iBAAiB,CAAC,GAAG,eAAe,CAAC;QAChD,UAAU,CAAC,eAAe,CAAC,GAAG,UAAU,CAAC,KAAK,CAAC,CAAC,KAAK;QAErD,OAAO,UAAU,CAAC;IACpB,CAAC;;gFAnJU,gBAAgB;8GAAhB,gBAAgB;QCd7B,sHAqGW;;QArGA,8FAA8B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACEzC;AAOA;AACA;AAEA;AAEA;;;;;;;;;;;;;;;;;;;;;ICoBcgB,4DAAAA;IACEA,uDAAAA;IAKAA,4DAAAA;IAAMA,oDAAAA;IAAkBA,0DAAAA;IACxBA,4DAAAA;IAA+CA,oDAAAA;IAAgBA,0DAAAA;;;;;;IAL7DA,uDAAAA;IAAAA,mEAAAA,mCAAAA,2DAAAA;IAIIA,uDAAAA;IAAAA,gEAAAA;IACyCA,uDAAAA;IAAAA,+DAAAA;;;;;;IAEjDA,4DAAAA;IACEA,uDAAAA;IAKAA,4DAAAA;IAAMA,oDAAAA;IAAgBA,0DAAAA;IACtBA,4DAAAA;IAA+CA,oDAAAA;IAAgBA,0DAAAA;;;;;;IAL7DA,uDAAAA;IAAAA,mEAAAA,kCAAAA,2DAAAA;IAIIA,uDAAAA;IAAAA,+DAAAA;IACyCA,uDAAAA;IAAAA,+DAAAA;;;;;;IArBnDA,4DAAAA;IAKEA,wDAAAA;IASAA,wDAAAA;IASFA,0DAAAA;;;;;IArBEA,wDAAAA;IAGMA,uDAAAA;IAAAA,wDAAAA;IASAA,uDAAAA;IAAAA,wDAAAA;;;;;;IAmCZA,uDAAAA;;;;;;;;;;;;;;IAuCMA,4DAAAA;IAIEA,wDAAAA;MAAAA,2DAAAA;MAAA;MAAA;MAAA;MAAA,OAASA,yDAAAA,2DAAT;IAAkD,CAAlD;IAGAA,uDAAAA;IAMAA,4DAAAA,WAAK,CAAL,EAAK,MAAL,EAAK,EAAL;IACyDA,oDAAAA;IAAmBA,0DAAAA;IAC1EA,4DAAAA;IACEA,oDAAAA;IACFA,0DAAAA;;;;;;;IAfFA,oEAAAA;IAGAA,yDAAAA;IAIEA,uDAAAA;IAAAA,mEAAAA;IADAA,wDAAAA,+BAAAA,2DAAAA,EAAyB,SAAzB,EAAyBA,6DAAAA,kFAAzB;IAMuDA,uDAAAA;IAAAA,+DAAAA;IAErDA,uDAAAA;IAAAA,gEAAAA;;;;;;IAjBRA,qEAAAA;IACEA,wDAAAA;IAoBFA,mEAAAA;;;;;;;IAnBKA,uDAAAA;IAAAA,wDAAAA;;;;;;IAqBPA,4DAAAA;IACEA,uDAAAA;IACFA,0DAAAA;;;;;IADeA,uDAAAA;IAAAA,wDAAAA,iCAAuB,UAAvB,EAAuBC,wBAAvB;;;;;;IA7CnBD,qEAAAA;IACEA,4DAAAA;IACEA,uDAAAA;IACAA,4DAAAA;IAA6CA,oDAAAA;IAA2BA,0DAAAA;IAE1EA,4DAAAA,eAAyD,CAAzD,EAAyD,IAAzD,EAAyD,EAAzD;IAEIA,oDAAAA;;IACAA,4DAAAA;IAIEA,uDAAAA;IACFA,0DAAAA;IAMJA,4DAAAA,gBAAkC,EAAlC,EAAkC,KAAlC,EAAkC,EAAlC;IAEIA,wDAAAA;;IAsBFA,0DAAAA;IACAA,wDAAAA;IAGFA,0DAAAA;IACFA,mEAAAA;;;;;;IA9CSA,uDAAAA;IAAAA,wDAAAA,oCAAAA,2DAAAA;IACwCA,uDAAAA;IAAAA,gEAAAA;IAI3CA,uDAAAA;IAAAA,gEAAAA,oBAAAA,yDAAAA;IAEEA,uDAAAA;IAAAA,oEAAAA,6FAAAA,2DAAAA;IAYiCA,uDAAAA;IAAAA,wDAAAA,YAAAA,yDAAAA;IAuB/BA,uDAAAA;IAAAA,wDAAAA;;;;;;IAjDZA,4DAAAA;IAKEA,wDAAAA;IAiDFA,0DAAAA;;;;;IAjDiBA,uDAAAA;IAAAA,wDAAAA;;;;;;;;IAyETA,4DAAAA;IAIEA,wDAAAA;MAAA;MAAA;MAAA;MAAA;MAAA,OAASA,yDAAAA,2DAAT;IAAkD,CAAlD;IAGAA,uDAAAA;IAMAA,4DAAAA,WAAM,CAAN,EAAM,MAAN,EAAM,EAAN;IAC2DA,oDAAAA;IAA2BA,0DAAAA;IACpFA,4DAAAA;IACEA,oDAAAA;IACFA,0DAAAA;;;;;;;IAfFA,oEAAAA;IAGAA,yDAAAA;IAIEA,uDAAAA;IAAAA,mEAAAA;IADAA,wDAAAA,uCAAAA,2DAAAA,EAAyB,SAAzB,EAAyBA,6DAAAA,8EAAzB;IAMyDA,uDAAAA;IAAAA,+DAAAA;IAEvDA,uDAAAA;IAAAA,gEAAAA;;;;;;IAKRA,4DAAAA;IACEA,uDAAAA;IACFA,0DAAAA;;;;;IADeA,uDAAAA;IAAAA,wDAAAA,iCAAuB,UAAvB,EAAuBE,wBAAvB;;;;;;IA3CrBF,4DAAAA;IAIEA,qEAAAA;IACEA,4DAAAA;IACEA,uDAAAA;IACAA,4DAAAA;IAA6CA,oDAAAA;IAAgBA,0DAAAA;IAE/DA,4DAAAA,eAAyD,CAAzD,EAAyD,IAAzD,EAAyD,EAAzD;IAEIA,oDAAAA;;IACAA,4DAAAA;IAIEA,uDAAAA;IACFA,0DAAAA;IAGJA,4DAAAA;IACIA,wDAAAA;;IAoBJA,0DAAAA;IACEA,wDAAAA;IAGJA,mEAAAA;IACFA,0DAAAA;;;;;;IAxCWA,uDAAAA;IAAAA,wDAAAA,mCAAAA,2DAAAA;IACwCA,uDAAAA;IAAAA,+DAAAA;IAI3CA,uDAAAA;IAAAA,gEAAAA,oBAAAA,yDAAAA;IAEEA,uDAAAA;IAAAA,oEAAAA,8GAAAA,2DAAAA;IASqBA,uDAAAA;IAAAA,wDAAAA,YAAAA,yDAAAA;IAoBnBA,uDAAAA;IAAAA,wDAAAA;;;;;;IApGdA,qEAAAA;IACEA,wDAAAA;IAyDAA,wDAAAA;IA+CFA,mEAAAA;;;;;IAvGKA,uDAAAA;IAAAA,wDAAAA;IA0DFA,uDAAAA;IAAAA,wDAAAA;;;;;;IA7DLA,4DAAAA;IACEA,wDAAAA;IA0GFA,0DAAAA;;;;;IA1GoCA,uDAAAA;IAAAA,wDAAAA;;;;ADpE9B,MAAOG,kBAAP,CAAyB;EAqC7BC,YACUC,IADV,EAEUC,kBAFV,EAGUC,kBAHV,EAIUC,iBAJV,EAKSC,cALT,EAKuC;IAJ7B;IACA;IACA;IACA;IACD;IAxCT,kBAAqB,EAArB;IACA,yBAAkB,EAAlB;IAEA,mBAAsB,KAAtB;IAEA,uBAA2B,EAA3B;IACA,8BAAmC,EAAnC;IACA,2BAA6B,EAA7B;IAGA,0BAAqBhB,yFAArB;IACA,yBAAoBA,wFAApB;IAEA,gBAAkB,EAAlB,CA2BuC,CA3BjB;;IACtB,cAAmB,EAAnB,CA0BuC,CA1BhB;;IACvB,yBAA2B,EAA3B,CAyBuC,CAzBR;;IAC/B,mBAAwB,EAAxB;IAEA,oBAA8B,IAA9B,CAsBuC,CAtBH;;IACpC,wBAAkC,IAAlC,CAqBuC,CArBC;;IACxC,uBAAiC,IAAjC,CAoBuC,CApBA;;IAKvC,sBAAiC,EAAjC;IAEA,uBAAoC,EAApC,CAauC,CAbC;;IACxC,8BAAuC,EAAvC,CAYuC,CAZI;;IAC3C,2BAA6B,EAA7B,CAWuC,CAXN;;IACjC,0BAA4B,EAA5B,CAUuC,CAVN;;IAY/B,KAAKoB,UAAL,GAAkB,IAAI7B,sDAAJ,CAAc;MAC9B8B,iBAAiB,EAAE,IAAI7B,wDAAJ,CAAgB,EAAhB,CADW,CACU;;IADV,CAAd,CAAlB;EAGD;;EAED8B,QAAQ;IACN,KAAKC,IAAL;EACD;;EAEDC,WAAW;IACT,MAAMC,MAAM,GAAG,4CAAf,CADS,CACoD;;IAC7D,OAAO,KAAKb,IAAL,CAAUc,GAAV,CAAqBD,MAArB,EAA6BE,IAA7B,CACLtB,0CAAG,CAAEuB,IAAD,IAAS;MACX,KAAKC,QAAL,GAAgBD,IAAhB;MACA,KAAKE,MAAL,GAAc,CAAC,GAAG,IAAIC,GAAJ,CAAQH,IAAI,CAACI,GAAL,CAAUC,IAAD,IAAUA,IAAI,CAACC,SAAxB,CAAR,CAAJ,CAAd;MACA,KAAKC,WAAL,GAAmB,CAAC,GAAG,IAAIJ,GAAJ,CAAQH,IAAI,CAACI,GAAL,CAAUC,IAAD,IAAUA,IAAI,CAACG,OAAxB,CAAR,CAAJ,CAAnB;IACD,CAJE,CADE,CAAP;EAOD,CA9D4B,CAgE7B;;;EACAC,YAAY,CAACC,IAAD,EAAa;IACvB;IACA,KAAKC,iBAAL,GAAyB,KAAKV,QAAL,CAAcW,MAAd,CAAsBP,IAAD,IAAUA,IAAI,CAACC,SAAL,KAAmBI,IAAlD,CAAzB;IACA,KAAKG,gBAAL,GAAwB,IAAxB,CAHuB,CAGO;;IAC9B,KAAKC,eAAL,GAAuB,IAAvB,CAJuB,CAIM;EAC9B,CAtE4B,CAwE7B;;;EACAC,gBAAgB,CAACP,OAAD,EAAgB;IAC9B;IACA,KAAKM,eAAL,GAAuBN,OAAvB;EACD;;EAEDQ,WAAW,CAACC,KAAD,EAAgC;IACzC,QAAQA,KAAK,CAACC,IAAd;MACE,KAAK,CAAL;QACE,OAAO,WAAP;;MACF,KAAK,CAAL;QACE,OAAO,UAAP;;MACF,KAAK,CAAL;QACE,OAAO,QAAP;;MACF;QACE,OAAO,MAAP;IARJ;EAUD;;EAEDvB,IAAI;IACF;IACA;IAEA,KAAKP,cAAL,CAAoB+B,IAApB,GAJE,CAI2B;IAE7B;;IACA,KAAKC,qBAAL;IAEA7C,yCAAE,CAAC,IAAD,CAAF,CAASwB,IAAT,CACE1B,gDAAS,CAAC,MAAK;MACb,OAAO,KAAKa,kBAAL,CAAwBmC,cAAxB,EAAP;IACD,CAFQ,CADX,EAIEhD,gDAAS,CAAEiD,KAAD,IAAe;MACvB,IAAIA,KAAK,IAAIA,KAAK,CAACC,OAAnB,EAA4B;QAC1BC,cAAc,CAACC,OAAf,CAAuB,UAAvB,EAAmCH,KAAK,CAACC,OAAzC;QACAG,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCH,cAAc,CAACI,OAAf,CAAuB,UAAvB,CAAhC,EAF0B,CAG1B;;QACA,OAAO,KAAK1C,kBAAL,CAAwB2C,eAAxB,EAAP;MACD,CALD,MAKO;QACL;QACA,OAAOtD,yCAAE,CAAC,EAAD,CAAT;MACD;IACF,CAVQ,CAJX,EAeEC,iDAAU,CAAEyC,KAAD,IAAU;MACnB;MACAS,OAAO,CAACT,KAAR,CAAc,QAAd,EAAwBA,KAAxB;MACA,OAAO1C,yCAAE,CAAC,EAAD,CAAT,CAHmB,CAGJ;IAChB,CAJS,CAfZ,EAoBEuD,SApBF,CAqBGC,GAAD,IAAQ;MACN,IAAIA,GAAG,IAAIA,GAAG,CAACR,OAAf,EAAwB;QACtB,KAAKS,cAAL,GAAsBD,GAAG,CAACR,OAA1B;QACAG,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgC,KAAKK,cAArC;QACA,KAAK5C,cAAL,CAAoB6C,IAApB;MACD,CAJD,MAIO;QACLP,OAAO,CAACT,KAAR,CAAc,iCAAd;QACA,KAAK7B,cAAL,CAAoB6C,IAApB;MACD;IACF,CA9BH;EAgCD;;EAEDb,qBAAqB;IACnB,KAAKjC,iBAAL,CAAuB+C,SAAvB,GAAmCJ,SAAnC,CAA8C9B,IAAD,IAAS;MACpD,IAAGA,IAAI,CAACmC,MAAL,GAAc,CAAjB,EAAoB;QAClB,KAAKC,sBAAL,GAA8BpC,IAA9B;MACD;IACF,CAJD;EAKD;;EAEDqC,uBAAuB,CAACC,MAAD,EAAe;IACpC;IACA,KAAK,IAAIC,QAAT,IAAqB,KAAKP,cAA1B,EAA0C;MACxC,MAAMQ,WAAW,GAAGD,QAAQ,CAACE,QAAT,CAAkBC,IAAlB,CAAuBC,KAAK,IAAIA,KAAK,CAACC,EAAN,KAAaN,MAA7C,CAApB;;MACA,IAAIE,WAAJ,EAAiB;QACf;QACA,OAAOD,QAAQ,CAACM,QAAhB;MACD;IACF,CARmC,CASpC;;;IACA,OAAO,IAAP;EACD;;EAEDC,sBAAsB,CAACC,KAAD,EAAaR,QAAb,EAA0B;IAC9C,IAAIS,QAAQ,GAAG,CAAf,CAD8C,CAG9C;;IACA,KAAK,MAAMC,SAAX,IAAwBF,KAAK,CAACG,kBAA9B,EAAkD;MAChD;MACA,KAAK,MAAMP,KAAX,IAAoBJ,QAAQ,CAACE,QAA7B,EAAuC;QACrC,IAAIQ,SAAS,CAACE,MAAV,KAAqBR,KAAK,CAACC,EAA/B,EAAmC;UACjCI,QAAQ,IAAIC,SAAS,CAACG,YAAtB;QACD;MACF;IACF;;IAED,OAAOJ,QAAP;EACD,CAzK4B,CA2K7B;;;EACAK,wBAAwB,CAACN,KAAD,EAAaR,QAAb,EAA0B;IAChD,KAAKe,gBAAL,GAAwBf,QAAxB;IACA,KAAKgB,aAAL,GAAqBR,KAArB;EACD;;EAEDS,aAAa,CAACC,KAAD,EAAa;IACxB,MAAMC,KAAK,GAAID,KAAK,CAACE,MAAN,CAAkCC,KAAjD,CADwB,CACiC;;IACzDlC,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqB+B,KAArB,EAFwB,CAEM;;IAE9B,IAAIA,KAAK,CAACvB,MAAN,IAAgB,CAApB,EAAuB;MACrB;MACA,KAAKjD,kBAAL,CAAwB2E,iBAAxB,CAA0CH,KAA1C,EAAiD5B,SAAjD,CACG9B,IAAD,IAAS;QACP,IAAIA,IAAI,IAAIA,IAAI,CAAC8D,SAAjB,EAA4B;UAC1B,KAAKC,eAAL,GAAuB/D,IAAI,CAACuB,OAA5B,CAD0B,CAG1B;;UACA,MAAMyC,8BAA8B,GAAG,KAAK5B,sBAAL,CACpChC,GADoC,CAChCC,IAAI,KAAK,EACZ,GAAGA,IADS;YAEZ4D,IAAI,EAAE5D,IAAI,CAAC4D,IAAL,CAAUC,OAAV,CAAkB,IAAlB,EAAwB,EAAxB,CAFM,CAEuB;;UAFvB,CAAL,CAD4B,EAKpCtD,MALoC,CAK7BP,IAAI,IACVA,IAAI,CAAC4D,IAAL,CAAUE,QAAV,CAAmBT,KAAnB,KAA6BrD,IAAI,CAAC+D,IAAL,CAAUD,QAAV,CAAmBT,KAAnB,CANM,CAAvC,CAJ0B,CAa1B;;UACA,MAAMW,wBAAwB,GAAGL,8BAA8B,CAAC5D,GAA/B,CAAmCC,IAAI,KAAK;YAC3EiE,IAAI,EAAEjE,IAAI,CAAC4D,IADgE;YAE3EG,IAAI,EAAE/D,IAAI,CAAC+D,IAFgE;YAG3EG,KAAK,EAAE;UAHoE,CAAL,CAAvC,CAAjC;UAMA,MAAMC,iBAAiB,GAAG,KAAKT,eAAL,CAAqB3D,GAArB,CAAyBC,IAAI,KAAK;YAC1DiE,IAAI,EAAEjE,IAAI,CAACoE,SAD+C;YAE1DL,IAAI,EAAE/D,IAAI,CAACqE,OAF+C;YAG1DH,KAAK,EAAE;UAHmD,CAAL,CAA7B,CAA1B;UAMAC,iBAAiB,CAACG,OAAlB,CAA0BtE,IAAI,IAAG;YAC/B,IAAI,CAAC,KAAKuE,mBAAL,CAAyBC,IAAzB,CAA8BC,YAAY,IAAIA,YAAY,CAACR,IAAb,KAAsBjE,IAAI,CAACiE,IAA3B,IAAmCQ,YAAY,CAACV,IAAb,KAAsB/D,IAAI,CAAC+D,IAA5G,CAAL,EAAwH;cACtH,KAAKQ,mBAAL,CAAyBG,IAAzB,CAA8B1E,IAA9B,EADsH,CAChF;YACvC;UACF,CAJD;UAMAgE,wBAAwB,CAACM,OAAzB,CAAiCtE,IAAI,IAAG;YACtC,IAAI,CAAC,KAAKuE,mBAAL,CAAyBC,IAAzB,CAA8BC,YAAY,IAAIA,YAAY,CAACR,IAAb,KAAsBjE,IAAI,CAACiE,IAA3B,IAAmCQ,YAAY,CAACV,IAAb,KAAsB/D,IAAI,CAAC+D,IAA5G,CAAL,EAAwH;cACtH,KAAKQ,mBAAL,CAAyBG,IAAzB,CAA8B1E,IAA9B,EADsH,CAChF;YACvC;UACF,CAJD;QAKD;MACF,CAxCH,EAyCGY,KAAD,IAAU;QACRS,OAAO,CAACT,KAAR,CAAc,WAAd,EAA2BA,KAA3B;MACD,CA3CH;IA6CD,CA/CD,MA+CO;MACL,KAAK2D,mBAAL,GAA2B,EAA3B;IACD;EACF;;EAEDI,QAAQ;IACNtD,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwB,KAAKsD,UAA7B;EACD;;EAEDC,oBAAoB;IAClB,KAAK9F,cAAL,CAAoB+B,IAApB;IACA7C,2CAAI,CAAC,KAAKW,kBAAL,CAAwBkG,kBAAxB,EAAD,CAAJ,CACGpF,IADH,CAEI1B,gDAAS,CAAE+G,QAAD,IAAa;MACrB,MAAMC,GAAG,GAAGD,QAAQ,CAACE,MAAT,CAAgBC,QAA5B;MACA,MAAMC,GAAG,GAAGJ,QAAQ,CAACE,MAAT,CAAgBG,SAA5B;MACA/D,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyB0D,GAAzB,EAA8B,YAA9B,EAA4CG,GAA5C;MAEA,KAAKD,QAAL,GAAgBF,GAAhB;MACA,KAAKI,SAAL,GAAiBD,GAAjB;MAEA9D,OAAO,CAACC,GAAR,CAAY,OAAZ;MAEA,OAAOpD,yCAAE,CAAC,EAAD,CAAT;IACD,CAXQ,CAFb,EAcIF,gDAAS,CAAE0D,GAAD,IAAQ;MAChB,IAAGA,GAAH,EAAQ;QACN,OAAO,KAAK7C,kBAAL,CAAwBmC,cAAxB,EAAP;MACD,CAFD,MAGI;QACF,OAAO,EAAP;MACD;IACF,CAPQ,CAdb,EAsBIhD,gDAAS,CAAEiD,KAAD,IAAe;MACvB,IAAIA,KAAK,IAAIA,KAAK,CAACC,OAAnB,EAA4B;QAC1BC,cAAc,CAACC,OAAf,CAAuB,UAAvB,EAAmCH,KAAK,CAACC,OAAzC;QACAG,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCH,cAAc,CAACI,OAAf,CAAuB,UAAvB,CAAhC,EAF0B,CAG1B;;QACA,OAAO,KAAK1C,kBAAL,CAAwB2C,eAAxB,EAAP;MACD,CALD,MAKO;QACL;QACA,OAAOtD,yCAAE,CAAC,EAAD,CAAT;MACD;IACF,CAVQ,CAtBb,EAiCIuD,SAjCJ,CAkCKC,GAAD,IAAQ;MACN,IAAIA,GAAJ,EAAS;QACP,KAAK2D,yBAAL;QACA,KAAKtG,cAAL,CAAoB6C,IAApB;MACD,CAHD,MAGO;QACLP,OAAO,CAACT,KAAR,CAAc,iCAAd;QACA,KAAK7B,cAAL,CAAoB6C,IAApB;MACD;IACF,CA1CL;EA4CD;;EAED0D,gBAAgB;IACd;IACA,KAAKC,mBAAL,GAA2B,EAA3B,CAFc,CAId;;IACA,KAAKC,eAAL,CAAqBlB,OAArB,CAA8B5B,KAAD,IAAU;MACrC,MAAM+C,gBAAgB,GAAG,EACvB,GAAG/C,KADoB;QAEvBwB,KAAK,EAAE,MAFgB;QAGvBwB,QAAQ,EAAEhD,KAAK,CAACiD,QAHO,CAGE;;MAHF,CAAzB;MAKA,KAAKJ,mBAAL,CAAyBb,IAAzB,CAA8Be,gBAA9B,EANqC,CAMY;IAClD,CAPD,EALc,CAcd;;IACA,KAAKG,sBAAL,CAA4BtB,OAA5B,CAAqC5B,KAAD,IAAU;MAC5C,MAAM+C,gBAAgB,GAAG,EACvB,GAAG/C,KADoB;QAEvBwB,KAAK,EAAE,IAFgB;QAGvBwB,QAAQ,EAAEhD,KAAK,CAACgD,QAHO,CAGE;;MAHF,CAAzB;MAKA,KAAKH,mBAAL,CAAyBb,IAAzB,CAA8Be,gBAA9B,EAN4C,CAMK;IAClD,CAPD,EAfc,CAwBd;;IACA,KAAKF,mBAAL,CAAyBM,IAAzB,CAA8B,CAACC,CAAD,EAAIC,CAAJ,KAAUD,CAAC,CAACJ,QAAF,GAAaK,CAAC,CAACL,QAAvD;IAEArE,OAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmC,KAAKiE,mBAAxC;EACD;;EAEDF,yBAAyB;IACvB,MAAMW,eAAe,GAAiB;MACpCC,eAAe,EAAE;QACfC,QAAQ,EAAE,KAAKhB,QADA;QAEfiB,SAAS,EAAE,KAAKf;MAFD,CADmB;MAKpCgB,cAAc,EAAE;QACdF,QAAQ,EAAE,KAAKhB,QADD;QAEdiB,SAAS,EAAE,KAAKf;MAFF;IALoB,CAAtC;IAWA,MAAMiB,kBAAkB,GAAa;MACnCH,QAAQ,EAAE,KAAKhB,QADoB;MAEnCiB,SAAS,EAAE,KAAKf;IAFmB,CAArC,CAZuB,CAiBvB;;IACA/G,+CAAQ,CAAC;MACPiI,WAAW,EAAE,KAAKzH,kBAAL,CAAwB0H,kBAAxB,CAA2CP,eAA3C,CADN;MAEPQ,UAAU,EAAE,KAAK1H,iBAAL,CAAuByH,kBAAvB,CAA0CF,kBAA1C;IAFL,CAAD,CAAR,CAGG5E,SAHH,CAIE,CAAC;MAAE6E,WAAF;MAAeE;IAAf,CAAD,KAAgC;MAC9B;MACA,IAAIF,WAAW,IAAIA,WAAW,CAACpF,OAA3B,IAAsCoF,WAAW,CAACpF,OAAZ,CAAoBuF,kBAA9D,EAAkF;QAChF,KAAKjB,eAAL,GAAuBc,WAAW,CAACpF,OAAZ,CAAoBuF,kBAApB,CAAuCZ,IAAvC,CACrB,CAACC,CAAD,EAAoBC,CAApB,KAA0CD,CAAC,CAACH,QAAF,GAAaI,CAAC,CAACJ,QADpC,CAAvB;MAGD,CAN6B,CAQ9B;;;MACA,IAAIa,UAAU,IAAIA,UAAU,CAAC3F,IAAX,KAAoB,CAAtC,EAAyC;QACvC,KAAK+E,sBAAL,GAA8BY,UAAU,CAAC7G,IAAX,CAAgBkG,IAAhB,CAC5B,CAACC,CAAD,EAAgBC,CAAhB,KAAkCD,CAAC,CAACJ,QAAF,GAAaK,CAAC,CAACL,QADrB,CAA9B;MAGD,CAb6B,CAe9B;;;MACA,KAAKJ,gBAAL;IACD,CArBH,EAsBG1E,KAAD,IAAU;MACRS,OAAO,CAACT,KAAR,CAAc,4BAAd,EAA4CA,KAA5C;IACD,CAxBH;EA0BD;;EAED8F,YAAY,CAAChE,KAAD,EAAkB;IAC5B,IAAIC,QAAQ,GAAW,CAAvB;IACAD,KAAK,CAACiE,IAAN,CAAWrC,OAAX,CAAoBsC,GAAD,IAAQ;MACzBjE,QAAQ,IAAIiE,GAAG,CAACC,GAAhB;IACD,CAFD;IAGA,OAAOlE,QAAP;EACD;;EAEDmE,OAAO,CAACF,GAAD,EAAS;IACd,OAAOA,GAAG,CAACG,OAAX;EACD;;EAEDC,WAAW,CAACJ,GAAD,EAAS;IAClB,OAAOA,GAAG,CAAC3C,IAAX;EACD;;EAEDgD,kBAAkB,CAACvE,KAAD,EAAoBkE,GAApB,EAA4B;IAC5C,OAAOA,GAAG,CAACC,GAAX;EACD;;AA3X4B;;;mBAAlBpI,oBAAkBH,+DAAAA,CAAAA,6DAAAA,GAAAA,+DAAAA,CAAAA,oFAAAA,GAAAA,+DAAAA,CAAAA,6FAAAA,GAAAA,+DAAAA,CAAAA,2FAAAA,GAAAA,+DAAAA,CAAAA,qEAAAA;AAAA;;;QAAlBG;EAAkByI;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCrB/BhJ,4DAAAA;MACEA,qEAAAA;MACEA,4DAAAA;MACEA,uDAAAA;MACAA,4DAAAA;MACEA,oDAAAA;MACFA,0DAAAA;MAGFA,4DAAAA,cAA8D,CAA9D,EAA8D,GAA9D;MACKA,oDAAAA;MAAiBA,0DAAAA;MAGtBA,4DAAAA;MAAMA,wDAAAA;QAAA,OAAYiJ,cAAZ;MAAsB,CAAtB;MACJjJ,4DAAAA,eAAqE,EAArE,EAAqE,gBAArE,EAAqE,CAArE,EAAqE,EAArE,EAAqE,UAArE,EAAqE,CAArE;MAG8CA,oDAAAA;MAAMA,0DAAAA;MAChDA,4DAAAA;MAGEA,wDAAAA;QAAA;MAAA,GAAwB,OAAxB,EAAwB;QAAA,OACfiJ,yBADe;MACM,CAD9B;MAHFjJ,0DAAAA;MAUAA,4DAAAA;MACEA,wDAAAA;MAwBFA,0DAAAA;MAIFA,4DAAAA,mBAMC,EAND,EAMC,UAND,EAMC,EAND;MAO4BA,oDAAAA;MAAMA,0DAAAA;MAChCA,oDAAAA;MACFA,0DAAAA;MAEAA,4DAAAA;MAIEA,wDAAAA;QAAA,OAASiJ,0BAAT;MAA+B,CAA/B;MAGAjJ,4DAAAA;MAA0BA,oDAAAA;MAAWA,0DAAAA;MACrCA,oDAAAA;MACFA,0DAAAA;MACAA,wDAAAA;;MAIFA,0DAAAA;MAEJA,mEAAAA;MACFA,0DAAAA;MAGAA,wDAAAA;;;;;;MApEYA,uDAAAA;MAAAA,wDAAAA,yBAAwB,SAAxB,EAAwBiJ,cAAxB,EAAwB,UAAxB,EAAwB,IAAxB;MAUoBjJ,uDAAAA;MAAAA,wDAAAA;MAgDDA,uDAAAA;MAAAA,wDAAAA,SAAAA,yDAAAA;MAUzBA,uDAAAA;MAAAA,wDAAAA;;;;;;;;;;;;;;;;;;;;;;ACrFqD;;;AAQpD,MAAM,wBAAwB;IAEnC,YACY,cAA8B;QAA9B,mBAAc,GAAd,cAAc,CAAgB;QAGxC,YAAO,GAAG,wFAA8B,CAAC;IAFrC,CAAC;IAIL,SAAS;QACP,MAAM,GAAG,GAAG,gCAAgC;QAC5C,OAAO,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,GAAG,CAAC;IACrC,CAAC;IAED,kBAAkB,CAAC,QAAkB;QACnC,MAAM,GAAG,GAAG,IAAI,CAAC,OAAO,GAAG,2GAAiD;QAC5E,MAAM,IAAI,GAAG;YACX,aAAa,EAAE,WAAW;YAC1B,UAAU,EAAE,EAAE;YACd,UAAU,EAAE,EAAE;YACd,UAAU,EAAE,QAAQ,CAAC,QAAQ;YAC7B,WAAW,EAAE,QAAQ,CAAC,SAAS;SAChC;QACD,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC;IAClD,CAAC;;gGAvBQ,wBAAwB;yHAAxB,wBAAwB,WAAxB,wBAAwB,mBAFvB,MAAM;;;;;;;;;;;;;;;;;;ACNuC;;;AAOpD,MAAM,yBAAyB;IAEpC,YACU,cAA8B;QAA9B,mBAAc,GAAd,cAAc,CAAgB;QAGxC,YAAO,GAAG,yFAA+B,CAAC;IAFtC,CAAC;IAIL,cAAc;QACZ,MAAM,GAAG,GAAG,IAAI,CAAC,OAAO,GAAG,yGAA+C,CAAC;QAC3E,MAAM,MAAM,GAAG,2FAAiC,CAAC;QAEjD,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;IAC/C,CAAC;IAED,iBAAiB,CAAC,OAAe;QAC/B,MAAM,GAAG,GAAG,IAAI,CAAC,OAAO,GAAG,+GAAqD,CAAC;QACjF,MAAM,MAAM,GAAG;YACb,OAAO,EAAE,cAAc,CAAC,OAAO,CAAC,UAAU,CAAC;YAC3C,SAAS,EAAE,OAAO;SACnB,CAAC;QACF,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;IAC/C,CAAC;IAED,kBAAkB,CAAC,QAAsB;QACvC,MAAM,GAAG,GAAG,IAAI,CAAC,OAAO,GAAG,gHAAsD,CAAC;QAClF,MAAM,MAAM,GAAG;YACb,OAAO,EAAE,cAAc,CAAC,OAAO,CAAC,UAAU,CAAC;SAC5C,CAAC;QACF,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,EAAE,MAAM,EAAE,QAAQ,CAAC;IACxD,CAAC;IAED,eAAe;QACb,MAAM,GAAG,GAAG,IAAI,CAAC,OAAO,GAAG,qGAA2C,CAAC;QACvE,MAAM,MAAM,GAAG;YACb,OAAO,EAAE,cAAc,CAAC,OAAO,CAAC,UAAU,CAAC;SAC5C,CAAC;QACF,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,EAAE,MAAM,CAAC;IAC9C,CAAC;IAED,iBAAiB,CAAC,OAAe;QAC/B,MAAM,GAAG,GAAG,IAAI,CAAC,OAAO,GAAG,4GAAkD,CAAC;QAC9E,MAAM,MAAM,GAAG;YACb,OAAO,EAAE,cAAc,CAAC,OAAO,CAAC,UAAU,CAAC;SAC5C,CAAC;QACF,MAAM,IAAI,GAAG;YACX,OAAO,EAAE,OAAO;YAChB,eAAe,EAAE;gBACf,QAAQ,EAAE,UAAU;gBACpB,SAAS,EAAE,WAAW;aACvB;SACF,CAAC;QACF,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,EAAE,MAAM,EAAE,IAAI,CAAC;IACpD,CAAC;IAED,cAAc;QACZ,MAAM,GAAG,GAAG,mCAAmC;QAC/C,OAAO,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,GAAG,CAAC;IACrC,CAAC;;kGA1DU,yBAAyB;0HAAzB,yBAAyB,WAAzB,yBAAyB,mBAFxB,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACP2B;AACF,CAAC,qBAAqB;AACd;AAErD,yBAAyB;AACyC,CAAE,gBAAgB;AACzB,CAAE,SAAS;AACb,CAAE,gBAAgB;AAClB,CAAE,wBAAwB;AACL;AACP,CAAC,sBAAsB;AACnC,CAAC,gBAAgB;AACrB;AACA;AAEP;AACS;AAEiB;AACH;;AAwBhE,MAAM,gBAAgB;;gFAAhB,gBAAgB;6GAAhB,gBAAgB;iHAdzB,yDAAY;QACZ,uDAAW;QACX,4EAAkB;QAClB,qEAAe;QACf,mEAAe;QACf,oEAAc;QACd,yFAAwB;QACxB,+DAAmB;QACnB,kFAAqB;QACrB,sEAAe;QACf,kEAAa;QACb,kEAAa;mIAGJ,gBAAgB,mBApBzB,mFAAgB;QAChB,gFAAkB;QAClB,wDAAS;QACT,iEAAa,aAGb,yDAAY;QACZ,uDAAW;QACX,4EAAkB;QAClB,qEAAe;QACf,mEAAe;QACf,oEAAc;QACd,yFAAwB;QACxB,+DAAmB;QACnB,kFAAqB;QACrB,sEAAe;QACf,kEAAa;QACb,kEAAa;;;;;;;;;;;;;;;;;ACpCV,MAAM,kBAAkB;IAC7B,gBAAe,CAAC;IAEhB,kBAAkB;QAChB,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;YACrC,IAAI,SAAS,CAAC,WAAW,EAAE;gBACzB,SAAS,CAAC,WAAW,CAAC,kBAAkB,CACtC,CAAC,QAAQ,EAAE,EAAE,CAAC,OAAO,CAAC,QAAQ,CAAC,EAC/B,CAAC,KAAK,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,CACzB,CAAC;aACH;iBAAM;gBACL,MAAM,CAAC,IAAI,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC;aACnC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;;oFAdU,kBAAkB;mHAAlB,kBAAkB,WAAlB,kBAAkB,mBAFjB,MAAM;;;;;;;;;;;;;;;;;ACFmB;;AAKhC,MAAM,cAAc;IAH3B;QAIU,mBAAc,GAAG,IAAI,iDAAe,CAAU,KAAK,CAAC,CAAC;QACtD,aAAQ,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC;KAStD;IAPC,IAAI;QACF,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACjC,CAAC;IAED,IAAI;QACF,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAClC,CAAC;;4EAVU,cAAc;+GAAd,cAAc,WAAd,cAAc,mBAFb,MAAM;;;;;;;;;;;;;;;;;ACH0C;;;AAMvD,MAAM,cAAc;IAEzB,YAAoB,IAAgB;QAAhB,SAAI,GAAJ,IAAI,CAAY;IAAG,CAAC;IAExC,GAAG,CAAC,GAAW,EAAE,SAAc,EAAE;QAC/B,IAAI,UAAU,GAAG,IAAI,4DAAU,EAAE,CAAC;QAElC,sBAAsB;QACtB,KAAK,MAAM,GAAG,IAAI,MAAM,EAAE;YACxB,IAAI,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;gBAC9B,UAAU,GAAG,UAAU,CAAC,GAAG,CAAC,GAAG,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;aAC/C;SACF;QAED,YAAY;QACZ,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,EAAE,MAAM,EAAE,UAAU,EAAE,CAAC,CAAC;IACpD,CAAC;IAED,IAAI,CAAC,GAAW,EAAE,MAAY,EAAE,IAAU;QACxC,IAAI,UAAU,GAAG,IAAI,4DAAU,EAAE,CAAC;QAElC,kCAAkC;QAClC,IAAI,MAAM,EAAE;YACV,KAAK,MAAM,GAAG,IAAI,MAAM,EAAE;gBACxB,IAAI,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;oBAC9B,UAAU,GAAG,UAAU,CAAC,GAAG,CAAC,GAAG,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;iBAC/C;aACF;SACF;QAED,aAAa;QACb,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,IAAI,EAAE,EAAE,EAAE,MAAM,EAAE,UAAU,EAAE,CAAC,CAAC;IACjE,CAAC;;4EAhCU,cAAc;+GAAd,cAAc,WAAd,cAAc,mBAFb,MAAM;;;;;;;;;;;;;;;ACLpB,gFAAgF;AAChF,mEAAmE;AACnE,gEAAgE;AAEzD,MAAM,WAAW,GAAG;IACzB,UAAU,EAAE,KAAK;IACjB,aAAa,EAAE;QACb,IAAI,EAAE,gEAAgE;QACtE,IAAI,EAAE,sCAAsC;QAC5C,UAAU,EAAE,sEAAsE;QAClF,QAAQ,EAAE;YACR,qBAAqB,EAAE,wBAAwB;YAC/C,cAAc,EAAE,iBAAiB;SAClC;KACF;IACD,cAAc,EAAE;QACd,IAAI,EAAE,qCAAqC;QAC3C,IAAI,EAAE,iDAAiD;QACvD,QAAQ,EAAE;YACR,WAAW,EAAE,+BAA+B;YAC5C,OAAO,EAAE,qCAAqC;YAC9C,iBAAiB,EAAE,wCAAwC;YAC3D,kBAAkB,EAAE,kDAAkD;YACtE,cAAc,EAAE,8CAA8C;SAC/D;QACD,MAAM,EAAE;YACN,KAAK,EAAE,6LAA6L;SACrM;KACF;CACF,CAAC;AAEF;;;;;;GAMG;AACH,sEAAsE;;;;;;;;;;;;;;;;;ACtCvB;AAGF;AACY;AAEzD,IAAI,6EAAsB,EAAE;IAC1B,6DAAc,EAAE,CAAC;CAClB;AAED,wEAAwB,CAAC,eAAe,CAAC,sDAAS,CAAC;KAChD,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC","sources":["./src/app/app-routing.module.ts","./src/app/app.component.ts","./src/app/app.component.html","./src/app/app.module.ts","./src/app/pipes/empty-info.pipe.ts","./src/app/pipes/round.pipe.ts","./src/app/search-food/model/family-mart.model.ts","./src/app/search-food/model/seven-eleven.model.ts","./src/app/search-food/new-search/display/display.component.ts","./src/app/search-food/new-search/display/display.component.html","./src/app/search-food/new-search/new-search.component.ts","./src/app/search-food/new-search/new-search.component.html","./src/app/search-food/new-search/services/family-mart-request.service.ts","./src/app/search-food/new-search/services/seven-eleven-request.service.ts","./src/app/search-food/search-food.module.ts","./src/app/services/geolocation.service.ts","./src/app/services/loading.service.ts","./src/app/services/request.service.ts","./src/environments/environment.ts","./src/main.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\n\nimport { NewSearchComponent } from './search-food/new-search/new-search.component';\n\nconst routes: Routes = [\n  { path: '**', component: NewSearchComponent },  // 所有其他路径都重定向到 /search\n];\n\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule { }\n","import { Component } from '@angular/core';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent {\n  title = 'friendly-time';\n}\n","<router-outlet></router-outlet>\n","import { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { HttpClientModule } from '@angular/common/http';\n\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\n\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatOptionModule } from '@angular/material/core';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\n\nimport { SearchFoodModule } from './search-food/search-food.module';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\nimport { EmptyInfoPipe } from './pipes/empty-info.pipe';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n  ],\n  imports: [\n    BrowserModule,\n    AppRoutingModule,\n    SearchFoodModule,\n    HttpClientModule,\n    BrowserAnimationsModule,\n    MatFormFieldModule,\n    MatSelectModule,\n    MatOptionModule,\n    MatProgressSpinnerModule,\n  ],\n  providers: [],\n  bootstrap: [AppComponent],\n})\nexport class AppModule { }\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'emptyInfo'\n})\nexport class EmptyInfoPipe implements PipeTransform {\n\n  transform(value: string): string {\n    // 如果字串為空，回傳 \"暫無資訊\"\n    return value === '' ? '暫無資訊' : value;\n  }\n\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'round'\n})\nexport class RoundPipe implements PipeTransform {\n\n  transform(value: any, precision: number = 0): any {\n    // 嘗試將輸入轉換為數字\n    const numericValue = parseFloat(value);\n\n    // 檢查是否是有效的數字\n    if (isNaN(numericValue)) {\n      return value;  // 如果不是有效的數字，返回原始輸入\n    }\n\n    // 使用 Math.round() 進行四捨五入\n    const factor = Math.pow(10, precision); // 計算小數位數\n    return Math.round(numericValue * factor) / factor; // 四捨五入到指定的精度\n  }\n\n}\n","export interface RequestModel {\n    latitude: number;          // 緯度\n    longitude: number;         // 經度\n    oldPKeys: string[];        // 店鋪的舊主鍵列表\n    postInfo: string;          // 郵遞區號或相關信息\n    projectCode: \"202106302\";  // 專案代碼\n}\n\nexport interface StoreModel {\n    oldPKey: string;\n    name: string;\n    tel: string | null;\n    post: string | null;\n    city: string | null;\n    areaCode: string | null;\n    periodType: number;\n    longitude: number;\n    latitude: number;\n    distance: number;\n    address: string;\n    updateDate: string;\n    info: ProductCategoryModel[];\n}\n\nexport interface ProductCategoryModel {\n    code: string;\n    name: string;\n    iconURL: string;\n    qty: number;\n    categories: SubCategoryModel[];\n}\n\nexport interface SubCategoryModel {\n    code: string;\n    name: string;\n    qty: number;\n    products: ProductModel[];\n}\n\nexport interface ProductModel {\n    code: string;\n    name: string;\n    qty: number;\n}\n\nexport interface fStore {\n  Name: string;           // 店名\n  Tel: string;            // 電話\n  addr: string;           // 地址\n  pkeynew: string;        // 新的 PKey\n  px_wgs84: string;       // 經度\n  py_wgs84: string;       // 緯度\n  serid: string;\n}\n","export interface Location {\n  Latitude: number;  // 經度\n  Longitude: number; // 緯度\n}\n\nexport interface LocationData {\n  CurrentLocation: Location;  // 當前位置\n  SearchLocation: Location;   // 搜索位置\n}\n\nexport interface Item {\n  ItemName: string;        // 商品名稱\n  RemainingQty: number;    // 剩餘數量\n}\n\nexport interface CategoryStockItem {\n  NodeID: number;               // 與FoodSubCategory的ID是對照\n  Name: string;                 // 食物子分類名稱\n  RemainingQty: number;         // 剩餘數量\n  ItemList: Item[];             // 該分類下的商品列表\n}\n\nexport interface StoreStockItem {\n  StoreNo: string;              // 商店編號\n  StoreName: string;            // 商店名稱\n  Distance: number;             // 與輸入位址的距離\n  IsOperateTime: boolean;       // 是否營業\n  RemainingQty: number;         // 該店總剩餘數量\n  CategoryStockItems: CategoryStockItem[]; // 商店所有的分類庫存資料\n}\n\nexport interface StoreStockResponse {\n  element: {\n      StoreStockItemList: StoreStockItem[];  // 包含所有商店的庫存資料\n  };\n  message: string;                      // 成功信息\n  isSuccess: boolean;                   // 是否成功\n  extend: any;                          // 其他擴展數據（可根據實際需求進行擴展）\n}\n\nexport interface FoodCategory {\n  ID: number;                    // 分類 ID\n  Name: string;                  // 食物分類名稱\n  ImageUrl: string;              // 圖片 URL\n  IsEnabled: boolean;            // 是否啟用\n  Children: FoodSubCategory[];   // 子分類列表\n  PCSCCategeroyNo: string[];     // 相關商品分類編號\n}\n\nexport interface FoodSubCategory {\n  ID: number;                     // 子分類 ID\n  Name: string;                   // 子分類名稱\n  IsEnabled: boolean;             // 是否啟用\n  PCSCCategeroyNo: string[];      // 子分類編號\n}\n\nexport interface FoodDetail {\n  name: string;\n  category: string;\n  content: string;\n  image: string;\n  kcal: string;\n  new: string;\n  price: string;\n  special_sale: string;\n  originalPrice?: string; // 新增原價屬性\n  discountedPrice?: string; // 新增折扣後價格屬性\n}\n\nexport interface Store {\n  StoreNo: string; // 商店編號\n  StoreName: string; // 商店名稱\n  StoreShortName: string; // 商店簡稱\n  IsEnabled: boolean; // 商店是否啟用\n  Latitude: number; // 緯度\n  Longitude: number; // 經度\n  Address: string; // 地址\n  IsXStore: boolean; // 是否是 X Store\n  IsOperateTime: boolean; // 是否有營業時間\n  HasStock: boolean; // 是否有庫存\n  Distance: number | null; // 距離，可能為 null\n}\n","import { Component, Input, OnChanges, SimpleChanges, OnInit, ElementRef, ViewChild } from '@angular/core';\n\nimport { FoodSubCategory, Item, CategoryStockItem, FoodDetail  } from '../../model/seven-eleven.model';  // 根據你的實際路徑導入模型\nimport { ProductModel } from '../../model/family-mart.model'\n\nimport { SevenElevenRequestService } from '../services/seven-eleven-request.service';  // 確保這個服務有方法可以查詢商店商品數量\n\nimport Fuse from 'fuse.js';\n\n@Component({\n  selector: 'app-display',\n  templateUrl: './display.component.html',\n  styleUrls: ['./display.component.scss']\n})\nexport class DisplayComponent implements OnChanges, OnInit {\n  @Input() store!: any;  // 接收父組件傳遞的 store\n  @Input() category!: any;  // 接收父組件傳遞的 category\n\n  subCategories: any[] = [];\n  itemsBySubCategory: { [key: string]: Item[] } = {};  // 儲存每個子分類的商品列表\n\n  foodDetails: FoodDetail[] = [];\n\n  constructor(\n    private sevenElevenRequestService: SevenElevenRequestService,\n  ) {}\n\n  ngOnInit() {\n    // 初始化的時候讀取存在.json的7-11商品細節\n    this.sevenElevenRequestService.getFoodDetails().subscribe((data) => {\n      this.foodDetails = data;\n      console.log(this.foodDetails);\n    })\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    // 若組件輸入有變化時，重新載入子商品列表\n    if (changes['category'] || changes['store']) {\n      this.loadSubCategories();  // 重新加載子分類資料\n    }\n  }\n\n  loadSubCategories() {\n    if (this.store && this.category) {\n      if (this.store.StoreName) {\n        this.subCategories = this.category.Children;  // 更新子分類列表\n        console.log('subCategories', this.subCategories);\n        this.loadItemsBySubCategory();  // 載入子分類下的所有商品資料\n      }\n      else if (this.store.name) {\n        this.subCategories = this.category.categories\n        console.log('subCategories', this.subCategories);\n        // 全家直接把商品丟進itemsBySubCategory\n        var items: Item[] = [];\n        this.subCategories.forEach((cat) => {\n          console.log('cat', cat)\n          items.push(\n            ...cat.products.map((product: ProductModel) => ({\n              ItemName: product.name,       // 映射到 ItemName\n              RemainingQty: product.qty,    // 映射到 RemainingQty\n            }))\n          );\n          this.itemsBySubCategory[cat.name] = items || [];\n          items = [];\n        });\n        console.log('itemsBySubCategory', this.itemsBySubCategory)\n      }\n    }\n  }\n\n  loadItemsBySubCategory() {\n    if (this.store) {\n      this.sevenElevenRequestService.getItemsByStoreNo(this.store.StoreNo).subscribe(response => {\n        if (response.isSuccess && response.element.StoreStockItem) {\n          const categoryStockItems: CategoryStockItem[] = response.element.StoreStockItem.CategoryStockItems;\n\n          this.subCategories.forEach(subCategory => {\n            const items: Item[] = [];\n\n            // 遍歷 CategoryStockItems，根據子分類名稱過濾並提取 ItemList\n            categoryStockItems.forEach(category => {\n              if (category.Name === subCategory.Name) {\n                items.push(...category.ItemList);\n              }\n            });\n\n            // 把結果保存到 itemsBySubCategory\n            this.itemsBySubCategory[subCategory.Name] = items || [];\n          });\n        }\n        console.log('itemsBySubCategory', this.itemsBySubCategory)\n      });\n    }\n  }\n\n  // getSubCategoryQty(subCategoryName: string): number {\n  //   let qty = 0;\n  //   const items = this.itemsBySubCategory[subCategoryName];\n  //   if (items) {\n  //     items.forEach(item => {\n  //       qty += item.RemainingQty;\n  //     });\n  //   }\n  //   return qty;\n  // }\n\n  getDiscountedPrice(originalPrice: string): string {\n    // 解析原價\n    const price = parseFloat(originalPrice.replace('NT$', '').trim());\n    const currentTime = new Date();\n    const currentHour = currentTime.getHours();\n\n    let discountedPrice = price;\n\n    // 設定折扣邏輯\n    if (currentHour >= 19 && currentHour < 20) {\n      discountedPrice *= 0.8; // 19:00~19:59 八折\n    } else if ((currentHour >= 10 && currentHour < 18) || (currentHour >= 20 || currentHour < 3)) {\n      discountedPrice *= 0.65; // 10:00~17:59 以及 20:00~03:00 六五折\n    }\n    else {\n      // 待查清其餘時段是幾折==，目前假設八折\n      discountedPrice *= 0.8;\n    }\n    return discountedPrice.toString();\n  }\n\n  getFoodDetail(item: Item): FoodDetail {\n    // 設置 Fuse.js 配置選項\n    const options = {\n      includeScore: true, // 需要包含匹配度分數\n      threshold: 0.3, // 設置模糊搜尋的閾值，0.3 表示較為寬鬆的匹配\n      keys: ['name'] // 搜尋的欄位是 'name'\n    };\n\n    // 初始化 Fuse 進行模糊搜尋\n    const fuse = new Fuse(this.foodDetails, options);\n\n    // 查找最匹配的項目\n    const result = fuse.search(item.ItemName);\n\n    // 如果找到匹配項，則返回最相似的那個\n    const foodDetail = result.length > 0 ? result[0].item : {\n      category: '',\n      content: '',\n      image: 'assets/此商品暫無圖片.png', // 默認圖片\n      kcal: '',\n      name: '',\n      new: 'False',\n      price: '',\n      special_sale: 'False'\n    };\n\n    // 計算折扣後的價格\n    const discountedPrice = this.getDiscountedPrice(foodDetail.price);\n\n    // 將計算結果新增到 foodDetail 物件中\n    foodDetail['discountedPrice'] = discountedPrice;\n    foodDetail['originalPrice'] = foodDetail.price; // 原價\n\n    return foodDetail;\n  }\n}\n","<mat-card *ngIf=\"subCategories.length > 0\" class=\"border-gray-300\">\n  <!-- 7-11顯示區塊 -->\n  <ng-container *ngIf=\"category.Name\">\n    <h2 class=\"text-2xl font-bold mb-4\">{{ category.Name }}</h2>\n    <ng-container *ngFor=\"let subCategory of subCategories\">\n      <div *ngIf=\"itemsBySubCategory[subCategory.Name] && itemsBySubCategory[subCategory.Name].length > 0\"\n           class=\"sub-category-item bg-white border border-gray-300 p-6 mb-8 rounded-lg shadow-lg\">\n        <div class=\"mb-4\">\n          <h3 class=\"text-2xl font-bold text-gray-800\">\n            {{ subCategory.Name }}\n          </h3>\n        </div>\n\n        <!-- 7-11顯示的子分類商品內容區塊 -->\n        <ul class=\"space-y-6 sm:space-y-4\">\n          <li *ngFor=\"let item of itemsBySubCategory[subCategory.Name]\">\n            <div class=\"food-item flex flex-col sm:flex-row items-start p-4 border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow\">\n              <img [src]=\"getFoodDetail(item).image\" [alt]=\"getFoodDetail(item).name\"\n                   class=\"object-contain rounded-lg mb-4 sm:mb-0 sm:mr-6 shadow-md w-24 h-24 sm:w-32 sm:h-32\">\n\n              <div class=\"flex-1\">\n                <!-- 商品名稱與標籤 -->\n                <div class=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-2\">\n                  <h3 class=\"text-sm sm:text-lg font-semibold text-gray-800\">\n                    {{ item.ItemName }}\n                  </h3>\n                  <div class=\"inline-block bg-green-100 text-green-800 text-xs sm:text-sm font-semibold px-4 py-2 rounded-full\">\n                    剩餘數量: {{ item.RemainingQty }}\n                  </div>\n                </div>\n\n                <!-- 商品標籤 -->\n                <div class=\"flex space-x-2 mb-2\">\n                  <div *ngIf=\"getFoodDetail(item).new === 'True'\"\n                       class=\"inline-block bg-red-100 text-red-800 text-xs font-semibold px-3 py-1 rounded-full\">\n                    新品\n                  </div>\n                  <div *ngIf=\"getFoodDetail(item).special_sale === 'True'\"\n                       class=\"inline-block bg-yellow-100 text-yellow-800 text-xs font-semibold px-3 py-1 rounded-full\">\n                    特價中\n                  </div>\n                </div>\n\n                <!-- 商品描述 -->\n                <div *ngIf=\"getFoodDetail(item).image !== 'assets/此商品暫無圖片.png'\">\n                  <div class=\"text-sm sm:text-base font-semibold text-gray-800 mb-2\">\n                    <span class=\"text-gray-800\">價格(NT$): </span>\n                    <span class=\"line-through text-gray-500\">{{ getFoodDetail(item).originalPrice }}</span>\n                    <span class=\"text-red-600 mx-2\">→</span>\n                    <span class=\"text-red-600\">\n                      {{ getFoodDetail(item).discountedPrice | round:0 }}\n                    </span>\n                  </div>\n                  <p class=\"text-xs sm:text-sm text-gray-500 mb-1\">商品描述: {{ getFoodDetail(item).content | emptyInfo}}</p>\n                  <p class=\"text-xs sm:text-sm text-gray-500 mb-1\">卡路里(kcal): {{ getFoodDetail(item).kcal | emptyInfo}}</p>\n                </div>\n                <!-- 商品沒資訊的話 -->\n                <div *ngIf=\"getFoodDetail(item).image === 'assets/此商品暫無圖片.png'\">\n                  <div class=\"text-sm sm:text-base font-semibold text-gray-800 mb-2\">\n                    <p class=\"text-xs sm:text-sm text-gray-500 mb-1\">商品描述: 暫無此商品資訊</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </li>\n        </ul>\n      </div>\n    </ng-container>\n  </ng-container>\n\n  <!-- 全家顯示區塊 -->\n  <ng-container *ngIf=\"category.name\">\n    <h2 class=\"text-2xl font-bold mb-4\">{{ category.name }}</h2>\n    <ng-container *ngFor=\"let subCategory of subCategories\">\n      <div *ngIf=\"itemsBySubCategory[subCategory.name] && itemsBySubCategory[subCategory.name].length > 0\"\n           class=\"sub-category-item bg-white border border-gray-300 p-6 mb-8 rounded-lg shadow-lg\">\n        <div class=\"mb-4\">\n          <h3 class=\"text-2xl font-bold text-gray-800\">\n            {{ subCategory.name }}\n          </h3>\n        </div>\n\n        <!-- 全家顯示的子分類商品內容區塊 -->\n        <ul class=\"space-y-6 sm:space-y-4\">\n          <li *ngFor=\"let item of itemsBySubCategory[subCategory.name]\">\n            <div class=\"food-item flex flex-col sm:flex-row items-start p-4 border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow\">\n              <div class=\"flex-1\">\n                <!-- 商品名稱 -->\n                <h3 class=\"text-sm sm:text-lg font-semibold text-gray-800\">\n                  {{ item.ItemName }}\n                </h3>\n                <div class=\"inline-block bg-green-100 text-green-800 text-xs sm:text-sm font-semibold px-4 py-2 rounded-full\">\n                  剩餘數量: {{ item.RemainingQty }}\n                </div>\n              </div>\n            </div>\n          </li>\n        </ul>\n      </div>\n    </ng-container>\n  </ng-container>\n</mat-card>\n","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { FormGroup, FormControl } from '@angular/forms';\n\nimport { GeolocationService } from 'src/app/services/geolocation.service';\nimport { SevenElevenRequestService } from './services/seven-eleven-request.service';\nimport { FamilyMartRequestService } from './services/family-mart-request.service';\nimport { LoadingService } from '../../services/loading.service'\n\nimport { FoodCategory, LocationData, StoreStockItem, Store, Location, CategoryStockItem } from '../model/seven-eleven.model'\nimport { fStore, StoreModel, ProductCategoryModel } from '../model/family-mart.model';\n\nimport { environment } from 'src/environments/environment';\n\nimport { switchMap, from, of, catchError, Observable, tap, forkJoin } from 'rxjs';\n\n@Component({\n  selector: 'app-new-search',\n  templateUrl: './new-search.component.html',\n  styleUrls: ['./new-search.component.scss'],\n})\nexport class NewSearchComponent implements OnInit {\n  searchForm: FormGroup; // 表單\n  searchTerm: string = '';\n  selectedStoreName='';\n\n  storeFilter: string = 'all';\n\n  dropDown711List: Store[] = [];\n  dropDownFamilyMartList: fStore[] = [];\n  unifiedDropDownList: any[] = [];\n\n\n  sevenElevenIconUrl = environment.sevenElevenUrl.icon;\n  familyMartIconUrl = environment.familyMartUrl.icon;\n\n  zipcodes: any[] = []; // 原始 API 資料\n  cities: string[] = []; // 縣市清單\n  filteredDistricts: any[] = []; // 篩選後的行政區列表\n  zipcodeList: string[] = [];\n\n  selectedCity: string | null = null; // 選擇的縣市\n  selectedDistrict: string | null = null; // 選擇的行政區\n  selectedZipcode: string | null = null; // 對應的郵遞區號\n\n  latitude!: number;\n  longitude!: number;\n\n  foodCategories: FoodCategory[] = [];\n\n  nearby711Stores: StoreStockItem[] = []; // 儲存用現在位置找到的711\n  nearbyFamilyMartStores: StoreModel[] = []; // 儲存用現在位置找到的全家\n  totalStoresShowList: any[] = []; //為了方便顯示所以統一\n  filteredStoresList: any[] = [];  // 用來儲存篩選後的商店列表\n\n  selectedStore?: any;\n  selectedCategory?: any;\n\n  constructor(\n    private http: HttpClient,\n    private geolocationService: GeolocationService,\n    private sevenElevenService: SevenElevenRequestService,\n    private familyMartService: FamilyMartRequestService,\n    public loadingService: LoadingService,\n  ) {\n    this.searchForm = new FormGroup({\n      selectedStoreName: new FormControl(''), // 控制選中的商店\n    });\n  }\n\n  ngOnInit(): void {\n    this.init();\n  }\n\n  getCityName(): Observable<any[]> {\n    const apiUrl = 'https://demeter.5fpro.com/tw/zipcodes.json'; // API URL\n    return this.http.get<any[]>(apiUrl).pipe(\n      tap((data) => {\n        this.zipcodes = data;\n        this.cities = [...new Set(data.map((item) => item.city_name))];\n        this.zipcodeList = [...new Set(data.map((item) => item.zipcode))];\n      })\n    );\n  }\n\n  // 當縣市選擇改變時\n  onCityChange(city: string): void {\n    // 根據選擇的縣市篩選行政區\n    this.filteredDistricts = this.zipcodes.filter((item) => item.city_name === city);\n    this.selectedDistrict = null; // 清空選中的行政區\n    this.selectedZipcode = null; // 清空郵遞區號\n  }\n\n  // 當行政區選擇改變時\n  onDistrictChange(zipcode: string): void {\n    // 更新選擇的郵遞區號\n    this.selectedZipcode = zipcode;\n  }\n\n  handleError(error: GeolocationPositionError): string {\n    switch (error.code) {\n      case 1:\n        return '使用者拒絕位置存取';\n      case 2:\n        return '無法取得位置資訊';\n      case 3:\n        return '位置請求逾時';\n      default:\n        return '未知錯誤';\n    }\n  }\n\n  init() {\n    // // 使用 from 將 Promise 轉換為 Observable\n    // this.getCityName();\n\n    this.loadingService.show();  // 显示加载动画\n\n    //取得所有全家商店名稱資訊\n    this.getFamilyMartAllStore();\n\n    of(true).pipe(\n      switchMap(() => {\n        return this.sevenElevenService.getAccessToken();\n      }),\n      switchMap((token: any) => {\n        if (token && token.element) {\n          sessionStorage.setItem('711Token', token.element);\n          console.log('Stored 711Token:', sessionStorage.getItem('711Token'));\n          // 如果 token 儲存成功，發送 getFoodCategory 請求\n          return this.sevenElevenService.getFoodCategory();\n        } else {\n          // 如果 token 沒有成功返回，返回空陣列\n          return of([]);\n        }\n      }),\n      catchError((error) => {\n        // 錯誤處理邏輯\n        console.error('Error:', error);\n        return of([]); // 在出錯時返回空陣列，防止應用崩潰\n      })\n    ).subscribe(\n      (res) => {\n        if (res && res.element) {\n          this.foodCategories = res.element;\n          console.log('Food Categories:', this.foodCategories);\n          this.loadingService.hide();\n        } else {\n          console.error('Failed to fetch food categories');\n          this.loadingService.hide();\n        }\n      }\n    );\n  }\n\n  getFamilyMartAllStore() {\n    this.familyMartService.getStores().subscribe((data) => {\n      if(data.length > 0) {\n        this.dropDownFamilyMartList = data;\n      }\n    })\n  }\n\n  getFoodSubCategoryImage(nodeID: number): string | null {\n    // 查找匹配的子分類\n    for (let category of this.foodCategories) {\n      const subCategory = category.Children.find(child => child.ID === nodeID);\n      if (subCategory) {\n        // 找到對應的子分類並返回其對應的分類圖片 URL\n        return category.ImageUrl;\n      }\n    }\n    // 如果沒有找到對應的子分類，返回 null\n    return null;\n  }\n\n  getSubCategoryTotalQty(store: any, category: any): number {\n    let totalQty = 0;\n\n    // 遍歷商店中的所有商品，檢查是否屬於當前分類及子分類\n    for (const stockItem of store.CategoryStockItems) {\n      // 遍歷每個分類的子項目，檢查是否屬於這個 category\n      for (const child of category.Children) {\n        if (stockItem.NodeID === child.ID) {\n          totalQty += stockItem.RemainingQty;\n        }\n      }\n    }\n\n    return totalQty;\n  }\n\n  // 當用戶點擊某個分類時，切換選中的分類與店鋪\n  toggleSubCategoryDetails(store: any, category: any): void {\n    this.selectedCategory = category;\n    this.selectedStore = store;\n  }\n\n  onSearchStore(event: Event): void {\n    const input = (event.target as HTMLInputElement).value;  // 確保這裡的值是有效的\n    console.log('輸入的值:', input);  // 確認輸入的值是否正確\n\n    if (input.length >= 2) {\n      // 假設這是你的API調用邏輯\n      this.sevenElevenService.getStoreByAddress(input).subscribe(\n        (data) => {\n          if (data && data.isSuccess) {\n            this.dropDown711List = data.element;\n\n            // 刪掉全家兩個字以免使用者誤搜，篩選 unifiedDropDownList，篩選條件是 Name 和 addr 都包含 input\n            const filteredDropDownFamilyMartList = this.dropDownFamilyMartList\n              .map(item => ({\n                ...item,\n                Name: item.Name.replace('全家', '')  // 去除 \"全家\" 字串\n              }))\n              .filter(item =>\n                item.Name.includes(input) || item.addr.includes(input)\n              );\n\n            // 統一兩個列表的名稱欄位\n            const normalizedFamilyMartList = filteredDropDownFamilyMartList.map(item => ({\n              name: item.Name,  // 統一名稱欄位\n              addr: item.addr,\n              label: '全家',\n            }));\n\n            const normalized711List = this.dropDown711List.map(item => ({\n              name: item.StoreName,  // 統一名稱欄位\n              addr: item.Address,\n              label: '7-11',\n            }));\n\n            normalized711List.forEach(item => {\n              if (!this.unifiedDropDownList.some(existingItem => existingItem.name === item.name && existingItem.addr === item.addr)) {\n                this.unifiedDropDownList.push(item);  // 同樣的檢查，防止重複\n              }\n            });\n\n            normalizedFamilyMartList.forEach(item => {\n              if (!this.unifiedDropDownList.some(existingItem => existingItem.name === item.name && existingItem.addr === item.addr)) {\n                this.unifiedDropDownList.push(item);  // 只有當 unifedDropDownList 中沒有該元素時才添加\n              }\n            });\n          }\n        },\n        (error) => {\n          console.error('API 請求錯誤:', error);\n        }\n      );\n    } else {\n      this.unifiedDropDownList = [];\n    }\n  }\n\n  onSubmit(): void {\n    console.log('提交的搜索內容:', this.searchTerm);\n  }\n\n  onUseCurrentLocation(): void {\n    this.loadingService.show()\n    from(this.geolocationService.getCurrentPosition())\n      .pipe(\n        switchMap((position) => {\n          const lat = position.coords.latitude;\n          const lng = position.coords.longitude;\n          console.log('Latitude:', lat, 'Longitude:', lng);\n  \n          this.latitude = lat;\n          this.longitude = lng;\n  \n          console.log('已取得位置');\n\n          return of([]);\n        }),\n        switchMap((res) => {\n          if(res) {\n            return this.sevenElevenService.getAccessToken();\n          }\n          else{\n            return [];\n          }\n        }),\n        switchMap((token: any) => {\n          if (token && token.element) {\n            sessionStorage.setItem('711Token', token.element);\n            console.log('Stored 711Token:', sessionStorage.getItem('711Token'));\n            // 如果 token 儲存成功，發送 getFoodCategory 請求\n            return this.sevenElevenService.getFoodCategory();\n          } else {\n            // 如果 token 沒有成功返回，返回空陣列\n            return of([]);\n          }\n        })\n      ).subscribe(\n        (res) => {\n          if (res) {\n            this.combineAndTransformStores();\n            this.loadingService.hide();\n          } else {\n            console.error('Failed to fetch food categories');\n            this.loadingService.hide();\n          }\n        }\n      );\n  }\n\n  combineStoreList(): void {\n    // 清空統一列表，避免重複累加\n    this.totalStoresShowList = [];\n    \n    // 處理 7-11 商店\n    this.nearby711Stores.forEach((store) => {\n      const transformedStore = {\n        ...store,\n        label: '7-11',\n        distance: store.Distance // 統一使用 `distance` 字段\n      };\n      this.totalStoresShowList.push(transformedStore); // 推入統一列表\n    });\n    \n    // 處理全家商店\n    this.nearbyFamilyMartStores.forEach((store) => {\n      const transformedStore = {\n        ...store,\n        label: '全家', // 加上來源標籤\n        distance: store.distance // 統一使用 `distance` 字段\n      };\n      this.totalStoresShowList.push(transformedStore); // 推入統一列表\n    });\n  \n    // 根據距離排序\n    this.totalStoresShowList.sort((a, b) => a.distance - b.distance);\n  \n    console.log('totalStoresShowList', this.totalStoresShowList);\n  }\n\n  combineAndTransformStores(): void {\n    const locationData711: LocationData = {\n      CurrentLocation: {\n        Latitude: this.latitude,\n        Longitude: this.longitude\n      },\n      SearchLocation: {\n        Latitude: this.latitude,\n        Longitude: this.longitude\n      }\n    };\n  \n    const locationFamilyMart: Location = {\n      Latitude: this.latitude,\n      Longitude: this.longitude\n    };\n  \n    // 結合兩個 API 請求\n    forkJoin({\n      sevenEleven: this.sevenElevenService.getNearByStoreList(locationData711),\n      familyMart: this.familyMartService.getNearByStoreList(locationFamilyMart)\n    }).subscribe(\n      ({ sevenEleven, familyMart }) => {\n        // 處理 7-11 資料\n        if (sevenEleven && sevenEleven.element && sevenEleven.element.StoreStockItemList) {\n          this.nearby711Stores = sevenEleven.element.StoreStockItemList.sort(\n            (a: StoreStockItem, b: StoreStockItem) => a.Distance - b.Distance\n          );\n        }\n  \n        // 處理全家資料\n        if (familyMart && familyMart.code === 1) {\n          this.nearbyFamilyMartStores = familyMart.data.sort(\n            (a: StoreModel, b: StoreModel) => a.distance - b.distance\n          );\n        }\n  \n        // 等兩者完成後合併資料\n        this.combineStoreList();\n      },\n      (error) => {\n        console.error('Error fetching store data:', error);\n      }\n    );\n  }\n\n  getFStoreQty(store: StoreModel): number {\n    var totalQty: number = 0;\n    store.info.forEach((cat) => {\n      totalQty += cat.qty;\n    })\n    return totalQty;\n  }\n\n  getFUrl(cat: any): string {\n    return cat.iconURL;\n  }\n\n  getFCatName(cat: any): string {\n    return cat.name;\n  }\n\n  getFSubCategoryQty(store: StoreModel, cat: any): number {\n    return cat.qty;\n  }\n}\n","<div class=\"container mx-auto my-8 p-6 bg-white shadow-lg rounded-lg max-w-4xl\">\n  <ng-container class=\"flex flex-col items-center\">\n    <div class=\"flex items-center justify-center mb-6 h-24\">\n      <img src=\"assets/S__222224406.jpg\" alt=\"Friendly Superhero\" class=\"w-12 h-12 sm:w-16 sm:h-16 md:w-24 md:h-24 rounded-full\">\n      <h5 class=\"text-xl sm:text-2xl font-bold ml-4 py-2 px-4 border-2 border-gray-300 rounded-full bg-white inline-block\">\n        看看附近有啥好吃的吧！\n      </h5>\n    </div>    \n    <!-- 提示訊息區域 -->\n    <div class=\"text-xs sm:text-sm text-red-600 mb-4 text-center\">\n      <p>* 資訊僅供參考，請以店內商品為準</p>\n    </div>\n\n    <form (ngSubmit)=\"onSubmit()\" class=\"w-full\">\n      <div class=\"flex flex-wrap justify-center gap-4 w-full items-center\">\n        <!-- 輸入框 -->\n        <mat-form-field class=\"w-full sm:w-3/4 lg:w-1/2\">\n          <mat-icon matSuffix class=\"text-gray-500\">search</mat-icon>\n          <input\n            matInput\n            [matAutocomplete]=\"auto\"\n            [(ngModel)]=\"searchTerm\"\n            (input)=\"onSearchStore($event)\"\n            placeholder=\"關鍵字搜尋功能施工中⋯⋯⋯敬請期待QQ\"\n            [disabled]=\"true\"\n            name=\"searchTerm\"\n            class=\"p-3 border-2 border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          />\n          <mat-autocomplete #auto=\"matAutocomplete\">\n            <mat-option\n              *ngFor=\"let store of unifiedDropDownList\"\n              [value]=\"store.label + store.name + '門市'\"\n              class=\"p-2 hover:bg-blue-100 focus:bg-blue-200\"\n            >\n              <div *ngIf=\"store.label === '7-11'\" class=\"flex items-center gap-2\">\n                <img\n                  src=\"{{ sevenElevenIconUrl }}\"\n                  alt=\"7-Eleven Icon\"\n                  class=\"w-4 h-4\"\n                />\n                <span>{{ store.name }}門市</span>\n                <span class=\"text-xs sm:text-sm text-gray-500\">{{ store.addr }}</span>\n              </div>\n              <div *ngIf=\"store.label === '全家'\" class=\"flex items-center gap-2\">\n                <img\n                  src=\"{{ familyMartIconUrl }}\"\n                  alt=\"FamilyMart Icon\"\n                  class=\"w-4 h-4\"\n                />\n                <span>{{ store.name }}</span>\n                <span class=\"text-xs sm:text-sm text-gray-500\">{{ store.addr }}</span>\n              </div>\n            </mat-option>\n          </mat-autocomplete>\n        </mat-form-field>\n\n        <!-- 第一個按鈕：查詢 -->\n        <button\n          type=\"submit\"\n          disabled=\"true\"\n          mat-raised-button\n          color=\"primary\"\n          class=\"ml-4 px-6 py-3 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center gap-2 text-xs sm:text-sm md:text-base\"\n        >\n          <mat-icon class=\"text-sm\">search</mat-icon>\n          關鍵字查詢施工中\n        </button>\n        <!-- 第二個按鈕：使用目前位置 -->\n        <button\n          type=\"button\"\n          mat-raised-button\n          color=\"warn\"\n          (click)=\"onUseCurrentLocation()\"\n          class=\"ml-4 px-6 py-3 bg-red-500 text-white rounded-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center gap-2 text-xs sm:text-sm md:text-base\"\n        >\n          <mat-icon class=\"text-sm\">location_on</mat-icon>\n          使用目前位置\n        </button>\n        <mat-progress-spinner *ngIf=\"loadingService.loading$ | async\" \n                      mode=\"indeterminate\" \n                      diameter=\"20\">\n        </mat-progress-spinner>\n      </div>\n    </form>\n  </ng-container>\n</div>\n\n<!-- 711與全家店家頁面 -->\n<div *ngIf=\"totalStoresShowList.length > 0\">\n  <ng-container *ngFor = \"let store of totalStoresShowList\" >\n    <div\n      *ngIf=\"store.RemainingQty > 0\"\n      class=\"store p-4 border border-gray-300 rounded-lg shadow-md mb-6\"\n    >\n      <!-- 711區塊 -->\n      <ng-container *ngIf=\"store.label === '7-11' && store.RemainingQty > 0\">\n        <div class=\"store-icon flex items-center mb-3\">\n          <img [src]=\"sevenElevenIconUrl\" alt=\"Store Icon\" class=\"w-6 h-6 mr-2\" />\n          <h2 class=\"text-lg sm:text-xl font-semibold\">7-11{{ store.StoreName }}門市</h2>\n        </div>\n        <div class=\"store-icon flex flex-col text-lg sm:text-xl\">\n          <h4 class=\"lg:text-lg sm:text-xl text-gray-500\">\n            距離: {{ store.distance | round:1 }} 公尺\n            <a \n              href=\"https://www.google.com/maps/search/7-ELEVEN{{ store.StoreName }}門市\" \n              target=\"_blank\" \n              class=\"ml-2\">\n              <img src=\"assets/GoogleMap_icon.png\" alt=\"Google Maps\" class=\"w-6 h-6 inline-block\"/>\n            </a>\n          </h4>\n        </div>\n        <!-- <div class=\"inline-block text-xs sm:text-sm font-semibold px-4 py-2 rounded-full\" [ngClass]=\"store.IsOperateTime ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'\">\n            {{ store.IsOperateTime ? '營業中' : '休息中' }}\n        </div> -->\n        <div class=\"food-categories mt-4\">\n          <div class=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-0\">\n            <ng-container *ngFor=\"let category of foodCategories | slice:0:10; let i = index\">\n              <div\n                *ngIf=\"getSubCategoryTotalQty(store, category) > 0\"\n                class=\"category border p-2 sm:p-3 md:p-4 rounded-lg text-center cursor-pointer w-full sm:w-full md:w-full \n                      {{ selectedCategory === category && selectedStore === store ? 'bg-blue-100' : '' }}\"\n                (click)=\"toggleSubCategoryDetails(store, category)\"\n                [class.pointer-events-none]=\"getSubCategoryTotalQty(store, category) === 0\"\n              >\n                <img\n                  [src]=\"category.ImageUrl\"\n                  alt=\"{{ category.Name }}\"\n                  class=\"w-12 h-12 sm:w-14 sm:h-14 md:w-16 md:h-16 lg:w-20 lg:h-20 mx-auto mb-2 object-cover\"\n                  [ngStyle]=\"{'opacity': getSubCategoryTotalQty(store, category) === 0 ? 0.3 : 1}\"\n                />\n                <div>\n                  <span class=\"block text-sm sm:text-base font-semibold\">{{ category.Name }}</span>\n                  <div class=\"inline-block text-xs bg-orange-200 text-orange-900 sm:text-sm font-semibold px-4 py-2 rounded-full\">\n                    {{ getSubCategoryTotalQty(store, category) }}\n                  </div>\n                </div>\n              </div>\n            </ng-container>\n          </div>        \n          <div *ngIf=\"selectedCategory && selectedStore === store\" class=\"sub-category-details mt-4\">\n            <app-display [store]=\"selectedStore\" [category]=\"selectedCategory\"></app-display>\n          </div>\n        </div>\n      </ng-container>\n    </div>\n  \n    <!-- 全家區塊 -->\n    <div\n    class=\"store p-4 border border-gray-300 rounded-lg shadow-md mb-6\"\n    *ngIf=\"store.label === '全家'\"\n    >\n      <ng-container>\n        <div class=\"store-icon flex items-center mb-3\">\n          <img [src]=\"familyMartIconUrl\" alt=\"Store Icon\" class=\"w-6 h-6 mr-2\" />\n          <h2 class=\"text-lg sm:text-xl font-semibold\">{{ store.name }}</h2>\n        </div>\n        <div class=\"store-icon flex flex-col text-lg sm:text-xl\">\n          <h4 class=\"lg:text-lg sm:text-xl text-gray-500\">\n            距離: {{ store.distance | round:1 }} 公尺\n            <a \n              href=\"https://www.google.com/maps/search/全家便利商店{{ store.name }}店\" \n              target=\"_blank\" \n              class=\"ml-2\">\n              <img src=\"assets/GoogleMap_icon.png\" alt=\"Google Maps\" class=\"w-6 h-6 inline-block\"/>\n            </a>\n          </h4>\n        </div>\n        <div class=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-0\">\n            <div\n              *ngFor=\"let category of store.info | slice:0:10; let i = index\"\n              class=\"category border p-2 sm:p-3 md:p-4 rounded-lg text-center cursor-pointer w-full sm:w-full md:w-full \n              {{ selectedCategory === category && selectedStore === store ? 'bg-blue-100' : '' }}\"\n              (click)=\"toggleSubCategoryDetails(store, category)\"\n              [class.pointer-events-none]=\"getFSubCategoryQty(store, category) === 0\"\n            >\n              <img\n                [src]=\"getFUrl(category)\"\n                alt=\"{{ getFCatName(category) }}\"\n                class=\"w-12 h-12 sm:w-14 sm:h-14 md:w-16 md:h-16 lg:w-20 lg:h-20 mx-auto mb-2 object-cover\"\n                [ngStyle]=\"{'opacity': getFSubCategoryQty(store, category) === 0 ? 0.3 : 1}\"\n              />\n              <div > \n                  <span class=\"block text-sm sm:text-base font-semibold\">{{ getFCatName(category) }}</span>\n                <div class=\"inline-block text-xs bg-orange-200 text-orange-900 sm:text-sm font-semibold px-4 py-2 rounded-full\">\n                  {{ getFSubCategoryQty(store, category) }}\n                </div>\n              </div>\n            </div>\n        </div>\n          <div *ngIf=\"selectedCategory && selectedStore === store\" class=\"sub-category-details mt-4 border-gray-700\">\n            <app-display [store]=\"selectedStore\" [category]=\"selectedCategory\" class=\"border-gray-700\"></app-display>\n          </div>\n      </ng-container>\n    </div>\n  </ng-container>\n</div>\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\n\nimport { environment } from 'src/environments/environment';\nimport { RequestService } from 'src/app/services/request.service'\n\nimport { Location } from '../../model/seven-eleven.model'\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class FamilyMartRequestService {\n\n  constructor(\n      private requestService: RequestService\n    ) { }\n\n    baseUrl = environment.familyMartUrl.base;\n\n    getStores(): Observable<any> {\n      const url = 'assets/family_mart_stores.json'\n      return this.requestService.get(url)\n    }\n\n    getNearByStoreList(location: Location): Observable<any> {\n      const url = this.baseUrl + environment.familyMartUrl.endpoint.mapProductInfo\n      const body = {\n        \"ProjectCode\": \"202106302\",\n        \"OldPKeys\": [],\n        \"PostInfo\": \"\",\n        \"Latitude\": location.Latitude,\n        \"Longitude\": location.Longitude\n      }\n      return this.requestService.post(url, null, body)\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\n\nimport { environment } from 'src/environments/environment';\nimport { RequestService } from 'src/app/services/request.service'\nimport { LocationData } from '../../model/seven-eleven.model';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SevenElevenRequestService {\n\n  constructor(\n    private requestService: RequestService\n  ) { }\n\n  baseUrl = environment.sevenElevenUrl.base;\n\n  getAccessToken(): Observable<any> {\n    const url = this.baseUrl + environment.sevenElevenUrl.endpoint.accessToken;\n    const params = environment.sevenElevenUrl.params;\n\n    return this.requestService.post(url, params);\n  }\n\n  getStoreByAddress(keyword: string): Observable<any> {\n    const url = this.baseUrl + environment.sevenElevenUrl.endpoint.getStoreByAddress;\n    const params = {\n      'token': sessionStorage.getItem('711Token'),\n      'keyword': keyword\n    };\n    return this.requestService.post(url, params);\n  }\n\n  getNearByStoreList(location: LocationData): Observable<any> {\n    const url = this.baseUrl + environment.sevenElevenUrl.endpoint.getNearbyStoreList;\n    const params = {\n      'token': sessionStorage.getItem('711Token')\n    };\n    return this.requestService.post(url, params, location)\n  }\n\n  getFoodCategory(): Observable<any> {\n    const url = this.baseUrl + environment.sevenElevenUrl.endpoint.getList;\n    const params = {\n      'token': sessionStorage.getItem('711Token')\n    };\n    return this.requestService.post(url, params)\n  }\n\n  getItemsByStoreNo(storeNo: string): Observable<any> {\n    const url = this.baseUrl + environment.sevenElevenUrl.endpoint.getStoreDetail;\n    const params = {\n      'token': sessionStorage.getItem('711Token'),\n    };\n    const body = {\n      storeNo: storeNo,\n      CurrentLocation: {\n        Latitude: 25.0375197,\n        Longitude: 121.5636704\n      }\n    };\n    return this.requestService.post(url, params, body)\n  }\n\n  getFoodDetails(): Observable<any> {\n    const url = 'assets/seven_eleven_products.json'\n    return this.requestService.get(url)\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms'; // 用於雙向綁定 [(ngModel)]\nimport { ReactiveFormsModule } from '@angular/forms';\n\n// 导入 Angular Material 模块\nimport { MatFormFieldModule } from '@angular/material/form-field';  // 用于 form-field\nimport { MatSelectModule } from '@angular/material/select';  // 用于下拉選單\nimport { MatOptionModule } from '@angular/material/core';  // 用于 mat-option\nimport { MatInputModule } from '@angular/material/input';  // 用于 mat-label 和其他输入框功能\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete'; // 用於 mat-autocomplete\nimport { MatButtonModule } from '@angular/material/button'; // 用於 mat-button\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatCardModule } from '@angular/material/card';\n\nimport { RoundPipe } from '../pipes/round.pipe';\nimport { EmptyInfoPipe } from '../pipes/empty-info.pipe';\n\nimport { DisplayComponent } from './new-search/display/display.component';\nimport { NewSearchComponent } from './new-search/new-search.component';\n\n@NgModule({\n  declarations: [\n    DisplayComponent,\n    NewSearchComponent,\n    RoundPipe,\n    EmptyInfoPipe\n  ],\n  imports: [\n    CommonModule,\n    FormsModule, // 支援 [(ngModel)]\n    MatFormFieldModule,  // 新增\n    MatSelectModule,     // 新增\n    MatOptionModule,     // 新增\n    MatInputModule,       // 新增\n    MatProgressSpinnerModule,\n    ReactiveFormsModule,\n    MatAutocompleteModule,\n    MatButtonModule,\n    MatIconModule,\n    MatCardModule\n  ]\n})\nexport class SearchFoodModule { }\n","import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class GeolocationService {\n  constructor() {}\n\n  getCurrentPosition(): Promise<GeolocationPosition> {\n    return new Promise((resolve, reject) => {\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(\n          (position) => resolve(position),\n          (error) => reject(error)\n        );\n      } else {\n        reject(new Error('瀏覽器不支援地理位置功能'));\n      }\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class LoadingService {\n  private loadingSubject = new BehaviorSubject<boolean>(false);\n  public loading$ = this.loadingSubject.asObservable();\n\n  show(): void {\n    this.loadingSubject.next(true);\n  }\n\n  hide(): void {\n    this.loadingSubject.next(false);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient, HttpParams } from '@angular/common/http';\nimport { Observable } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class RequestService {\n\n  constructor(private http: HttpClient) {}\n\n  get(url: string, params: any = {}): Observable<any> {\n    let httpParams = new HttpParams();\n\n    // 處理 query parameters\n    for (const key in params) {\n      if (params.hasOwnProperty(key)) {\n        httpParams = httpParams.set(key, params[key]);\n      }\n    }\n\n    // 發送 GET 請求\n    return this.http.get(url, { params: httpParams });\n  }\n\n  post(url: string, params?: any, body?: any): Observable<any> {\n    let httpParams = new HttpParams();\n\n    // 直接將 params 加入 httpParams，不做物件檢查\n    if (params) {\n      for (const key in params) {\n        if (params.hasOwnProperty(key)) {\n          httpParams = httpParams.set(key, params[key]);\n        }\n      }\n    }\n\n    // 發送 POST 請求\n    return this.http.post(url, body || {}, { params: httpParams });\n  }\n}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false,\n  familyMartUrl: {\n    icon: 'https://www.family.com.tw/NewEnterprise/CSR/images/favicon.ico',\n    base: 'https://stamp.family.com.tw/api/maps',\n    storeQuery: 'https://family.map.com.tw/famiport/api/dropdownlist/Select_StoreName',\n    endpoint: {\n      mapClassificationInfo: '/MapClassificationInfo',\n      mapProductInfo: '/MapProductInfo'\n    }\n  },\n  sevenElevenUrl: {\n    icon: 'https://www.7-11.com.tw/favicon.ico',\n    base: 'https://lovefood.openpoint.com.tw/LoveFood/api/',\n    endpoint: {\n      accessToken: 'Auth/FrontendAuth/AccessToken',\n      getList: 'Master/FrontendItemCategory/GetList',\n      getStoreByAddress: 'Master/FrontendStore/GetStoreByAddress',\n      getNearbyStoreList: 'Search/FrontendStoreItemStock/GetNearbyStoreList',\n      getStoreDetail: 'Search/FrontendStoreItemStock/GetStoreDetail'\n    },\n    params: {\n      mid_v: 'W0_DiF4DlgU5OeQoRswrRcaaNHMWOL7K3ra3389ocJQv-rdOWS6Zu4AtGa7-7pjiccl0C5gm0u5UNONXuVUXcJCidRjIv9dsUd8PocNr5moiuJJ8hZla5iV0H3-8dZfASc7GgEm74679LYK2hBB-Sam6D0LAnYK9Lb0DZjaSctnHS5yYugtrYNdWoWk'\n    }\n  }\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/plugins/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"],"names":["FormGroup","FormControl","FoodCategory","LocationData","StoreStockItem","Store","Location","fStore","StoreModel","environment","switchMap","from","of","catchError","tap","forkJoin","i0","ctx_r15","ctx_r29","NewSearchComponent","constructor","http","geolocationService","sevenElevenService","familyMartService","loadingService","sevenElevenUrl","icon","familyMartUrl","searchForm","selectedStoreName","ngOnInit","init","getCityName","apiUrl","get","pipe","data","zipcodes","cities","Set","map","item","city_name","zipcodeList","zipcode","onCityChange","city","filteredDistricts","filter","selectedDistrict","selectedZipcode","onDistrictChange","handleError","error","code","show","getFamilyMartAllStore","getAccessToken","token","element","sessionStorage","setItem","console","log","getItem","getFoodCategory","subscribe","res","foodCategories","hide","getStores","length","dropDownFamilyMartList","getFoodSubCategoryImage","nodeID","category","subCategory","Children","find","child","ID","ImageUrl","getSubCategoryTotalQty","store","totalQty","stockItem","CategoryStockItems","NodeID","RemainingQty","toggleSubCategoryDetails","selectedCategory","selectedStore","onSearchStore","event","input","target","value","getStoreByAddress","isSuccess","dropDown711List","filteredDropDownFamilyMartList","Name","replace","includes","addr","normalizedFamilyMartList","name","label","normalized711List","StoreName","Address","forEach","unifiedDropDownList","some","existingItem","push","onSubmit","searchTerm","onUseCurrentLocation","getCurrentPosition","position","lat","coords","latitude","lng","longitude","combineAndTransformStores","combineStoreList","totalStoresShowList","nearby711Stores","transformedStore","distance","Distance","nearbyFamilyMartStores","sort","a","b","locationData711","CurrentLocation","Latitude","Longitude","SearchLocation","locationFamilyMart","sevenEleven","getNearByStoreList","familyMart","StoreStockItemList","getFStoreQty","info","cat","qty","getFUrl","iconURL","getFCatName","getFSubCategoryQty","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}